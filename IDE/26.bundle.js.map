{"version":3,"sources":["webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/style/index.css","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/bibtex-grammar.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/latex-engine.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/latex-grammar.ts","webpack:////home/elliott/playground/test/theia/packages/latex/lib/browser/latex-log-parser.js","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/latex-preview-widget.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/monaco-yjs.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/theia-latex-contribution.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/theia-latex-frontend-module.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/theia-latex-spellchecker.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/xdv-exporter.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/xdv-machine.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/xdv-parser.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/common/index.ts","webpack:////home/elliott/playground/test/theia/packages/latex/src/browser/style/index.css?7037","webpack:////home/elliott/playground/test/theia/packages/monaco/src/browser/textmate/textmate-contribution.ts","webpack:///zlib (ignored)","webpack:///fs (ignored)?7a35","webpack:///http (ignored)","webpack:///https (ignored)"],"names":[],"mappings":"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CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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","file":"26.bundle.js","sourcesContent":["exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".swiftlatex-preview-widget {\\n\\n}\\n\\n.pf-line {\\n  line-height: 1.00;\\n  white-space: pre;\\n  position: absolute;\\n}\\n\\n.pf-space {\\n  display: inline-block;\\n}\\n\\n#swiftlatex_preview_viewer {\\n  background-color: #9c9c9c; margin: 0; padding:0; border: 0;\\n  width: 100%;\\n  height: 96%; \\n  overflow-x: scroll;\\n  overflow-y: scroll;\\n}\\n\\n.page_decoration {\\n  margin: 0 auto; background-color: white;\\n  transform-origin: 50% 0;\\n}\\n\\n\\n.swiftlatex-preview-toolbar {\\n    margin-top: 8px;\\n    display: flex;\\n    align-items: center;\\n    justify-content: space-evenly;\\n    padding: 0 10px;\\n}\\n\\n.swiftlatex-preview-toolbar-button {\\n    min-width: 1rem;\\n    text-align: center;\\n    flex-grow: 0;\\n    font-family: FontAwesome;\\n    font-size: 16px;\\n    margin: 0px 4px 0px 4px;\\n}\\n\\n.swiftlatex-preview-toolbar-previous::before {\\n    content: \\\"\\\\F053\\\";\\n}\\n\\n.swiftlatex-preview-toolbar-next::before {\\n    content: \\\"\\\\F054\\\";\\n}\\n\\n.swiftlatex-preview-toolbar-zoomout::before {\\n    content: \\\"\\\\F010\\\";\\n}\\n\\n.swiftlatex-preview-toolbar-zoomin::before {\\n    content: \\\"\\\\F00E\\\";\\n}\\n\\n.swiftlatex-preview-toolbar-input {\\n    width: 40%;\\n    line-height: 1.00;\\n    margin-left: 4px;\\n    margin-right: 4px;\\n    text-align: center; \\n}\\n\\n.viewercursor {\\n  border-right: 1px solid red;\\n}\", \"\"]);\n\n// exports\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { LanguageGrammarDefinitionContribution, TextmateRegistry, GrammarDefinition } from '@theia/monaco/lib/browser/textmate';\nimport { injectable } from 'inversify';\n\n@injectable()\nexport class BibTeXContribution implements LanguageGrammarDefinitionContribution {\n    readonly BibTEX_LANGUAGE_ID = 'bibtex';\n\n    readonly config: monaco.languages.LanguageConfiguration = {\n        'comments': {\n            'lineComment': '%'\n        },\n        'brackets': [\n            ['{', '}'],\n            ['[', ']'],\n            ['(', ')']\n        ],\n        'autoClosingPairs': [\n            { 'open': '{', 'close': '}', 'notIn': ['string'] },\n            { 'open': '[', 'close': ']', 'notIn': ['string'] },\n            { 'open': '(', 'close': ')', 'notIn': ['string'] },\n            { 'open': '`', 'close': '`', 'notIn': ['string', 'comment'] },\n            { 'open': '\"', 'close': '\"', 'notIn': ['string', 'comment'] },\n            { 'open': '$', 'close': '$', 'notIn': ['string', 'comment'] }\n        ],\n        'surroundingPairs': [\n            { 'open': '{', 'close': '}' },\n            { 'open': '[', 'close': ']' },\n            { 'open': '(', 'close': ')' },\n            { 'open': '`', 'close': '`' },\n            { 'open': '\"', 'close': '\"' },\n            { 'open': '$', 'close': '$' }\n        ]\n    };\n\n    registerTextmateLanguage(registry: TextmateRegistry): void {\n        monaco.languages.register({\n            id: this.BibTEX_LANGUAGE_ID,\n            'aliases': [\n                'BibTeX',\n                'bibtex'\n            ],\n            'extensions': [\n                '.bib'\n            ],\n            'mimetypes': [\n                'text/bibtex'\n            ]\n        });\n\n        monaco.languages.setLanguageConfiguration(this.BibTEX_LANGUAGE_ID, this.config);\n\n        const biblatexGrammar = require('../../data/Bibtex.tmLanguage.json');\n        registry.registerTextmateGrammarScope('text.bibtex', {\n            async getGrammarDefinition(): Promise<GrammarDefinition> {\n                return {\n                    format: 'json',\n                    content: biblatexGrammar\n                };\n            }\n        });\n\n        registry.mapLanguageIdToTextmateGrammar(this.BibTEX_LANGUAGE_ID, 'text.bibtex');\n    }\n}\n","/********************************************************************************\n * Copyright (C) 2019 Elliott Wen.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { injectable } from 'inversify';\nexport enum EngineStatus {\n\tInit = 1,\n\tReady,\n\tBusy,\n\tError\n}\n\nconst ENGINE_PATH = '/bin/swiftlatex.js';\n\nexport class CompileResult {\n\tpdf: Uint8Array | undefined = undefined;\n\tstatus: number = -254;\n\tlog: string = 'No log';\n}\n\n@injectable()\nexport class LaTeXEngine {\n\tprivate latexWorker: Worker | undefined = undefined;\n\tpublic latexWorkerStatus: EngineStatus = EngineStatus.Init;\n\tconstructor() {\n\t\tthis.loadEngine().then(_ => {\n\t\t\tconsole.log('Engine is ready to go now');\n\t\t}).catch(e => {\n\t\t\tconsole.error('Engine fails to load.');\n\t\t});\n\t}\n\n\tpublic isReady(): boolean {\n\t\treturn this.latexWorkerStatus === EngineStatus.Ready;\n\t}\n\n\tpublic async loadEngine(): Promise<void> {\n\t\tif (this.latexWorker !== undefined) {\n\t\t\tthrow new Error('Other instance is running, abort()');\n\t\t}\n\t\tthis.latexWorkerStatus = EngineStatus.Init;\n\t\tawait new Promise((resolve, reject) => {\n\t\t\tthis.latexWorker = new Worker(ENGINE_PATH);\n\t\t\tthis.latexWorker.onmessage = (ev: any) => {\n\t\t\t\tconst data: any = ev['data'];\n\t\t\t\tconst cmd: string = <string>(data['cmd']);\n\t\t\t\tif (cmd === 'postRun') {\n\t\t\t\t\tthis.latexWorkerStatus = EngineStatus.Ready;\n\t\t\t\t\tresolve();\n\t\t\t\t} else {\n\t\t\t\t\tthis.latexWorkerStatus = EngineStatus.Error;\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.latexWorker.onerror = (ev: any) => {\n\t\t\t\treject();\n\t\t\t};\n\t\t});\n\n\t\tthis.latexWorker!.onmessage = (ev: any) => {\n\t\t};\n\t\tthis.latexWorker!.onerror = (ev: any) => {\n\t\t};\n\t}\n\n\tprivate checkEngineStatus(): void {\n\t\tif (this.latexWorkerStatus !== EngineStatus.Ready) {\n\t\t\tthrow Error('Engine is still spinning or not ready yet!');\n\t\t}\n\t}\n\n\tpublic async compileLaTeX(): Promise<CompileResult> {\n\t\tthis.checkEngineStatus();\n\t\tthis.latexWorkerStatus = EngineStatus.Busy;\n\t\tconst start_compile_time = performance.now();\n\t\tconst res: CompileResult = await new Promise((resolve, reject) => {\n\t\t\tthis.latexWorker!.onmessage = (ev: any) => {\n\t\t\t\tconst data: any = ev['data'];\n\t\t\t\tconst cmd: string = <string>(data['cmd']);\n\t\t\t\tconst result: string = <string>data['result'];\n\t\t\t\tconst log: string = <string>data['log'];\n\t\t\t\tconst status: number = <number>data['status'];\n\t\t\t\tconst pdf: Uint8Array = new Uint8Array(data['pdf']);\n\t\t\t\tif (cmd === 'compile') {\n\t\t\t\t\tthis.latexWorkerStatus = EngineStatus.Ready;\n\t\t\t\t\tif (result === 'failed') {\n\t\t\t\t\t\tconsole.error('Engine crushed terribly. Log: ' + log);\n\t\t\t\t\t\tthis.latexWorkerStatus = EngineStatus.Error;\n\t\t\t\t\t\treject(log);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('Engine compilation finish ' + (performance.now() - start_compile_time));\n\t\t\t\t\t\tconst nice_report = new CompileResult();\n\t\t\t\t\t\tnice_report.status = status;\n\t\t\t\t\t\tnice_report.log = log;\n\t\t\t\t\t\tnice_report.pdf = pdf;\n\t\t\t\t\t\tresolve(nice_report);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.latexWorker!.postMessage({ 'cmd': 'compilelatex' });\n\t\t});\n\n\t\tthis.latexWorker!.onmessage = (ev: any) => {\n\t\t};\n\t\treturn res;\n\t}\n\n\t/* Internal Use */\n\tpublic async compileFormat(): Promise<void> {\n\t\tthis.checkEngineStatus();\n\t\tthis.latexWorkerStatus = EngineStatus.Busy;\n\t\tawait new Promise((resolve, reject) => {\n\t\t\tthis.latexWorker!.onmessage = (ev: any) => {\n\t\t\t\tconst data: any = ev['data'];\n\t\t\t\tconst cmd: string = <string>(data['cmd']);\n\t\t\t\tif (cmd === 'compile') {\n\t\t\t\t\tif (data['status'] === 0) {\n\t\t\t\t\t\tconst formatArray = data['pdf']; /* PDF for result */\n\t\t\t\t\t\tconst formatBlob = new Blob([formatArray], { type: 'application/octet-stream' });\n\t\t\t\t\t\tconst formatURL = URL.createObjectURL(formatBlob);\n\t\t\t\t\t\tsetTimeout(() => { URL.revokeObjectURL(formatURL); }, 30000);\n\t\t\t\t\t\tconsole.log('Download format file via ' + formatURL);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(data['log']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.latexWorker!.postMessage({ 'cmd': 'compileformat' });\n\t\t});\n\t\tthis.latexWorker!.onmessage = (ev: any) => {\n\t\t};\n\t}\n\n\tpublic setEngineMainFile(filename: string): void {\n\t\tthis.checkEngineStatus();\n\t\tif (this.latexWorker !== undefined) {\n\t\t\tthis.latexWorker.postMessage({ 'cmd': 'setmainfile', 'url': filename });\n\t\t}\n\t}\n\n\tpublic writeMemFSFile(srccode: string | Uint8Array, filename: string): void {\n\t\tthis.checkEngineStatus();\n\t\tif (this.latexWorker !== undefined) {\n\t\t\tthis.latexWorker.postMessage({ 'cmd': 'writefile', 'url': filename, 'src': srccode });\n\t\t}\n\t}\n\n\tpublic makeMemFSFolder(folder: string): void {\n\t\tthis.checkEngineStatus();\n\t\tif (this.latexWorker !== undefined) {\n\t\t\tif (folder === '' || folder === '/') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.latexWorker.postMessage({ 'cmd': 'mkdir', 'url': folder });\n\t\t}\n\t}\n\n\tpublic flushCache(): void {\n\t\tthis.checkEngineStatus();\n\t\tif (this.latexWorker !== undefined) {\n\t\t\tconsole.warn('Flushing');\n\t\t\tthis.latexWorker.postMessage({ 'cmd': 'flushcache' });\n\t\t}\n\n\t}\n\n\tpublic closeWorker(): void {\n\t\tif (this.latexWorker !== undefined) {\n\t\t\tthis.latexWorker.postMessage({ 'cmd': 'grace' });\n\t\t\tthis.latexWorker = undefined;\n\t\t}\n\t}\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { LanguageGrammarDefinitionContribution, TextmateRegistry, GrammarDefinition } from '@theia/monaco/lib/browser/textmate';\nimport { injectable } from 'inversify';\n\n@injectable()\nexport class TeXContribution implements LanguageGrammarDefinitionContribution {\n    readonly TEX_LANGUAGE_ID = 'latex';\n\n    readonly config: monaco.languages.LanguageConfiguration = {\n        'comments': {\n            'lineComment': '%'\n        },\n        'brackets': [\n            ['{', '}'],\n            ['[', ']'],\n            ['(', ')']\n        ],\n        'autoClosingPairs': [\n            { 'open': '{', 'close': '}', 'notIn': ['string'] },\n            { 'open': '[', 'close': ']', 'notIn': ['string'] },\n            { 'open': '(', 'close': ')', 'notIn': ['string'] },\n            { 'open': '`', 'close': '`', 'notIn': ['string', 'comment'] },\n            { 'open': '\"', 'close': '\"', 'notIn': ['string', 'comment'] },\n            { 'open': '$', 'close': '$', 'notIn': ['string', 'comment'] }\n        ],\n        'surroundingPairs': [\n            { 'open': '{', 'close': '}' },\n            { 'open': '[', 'close': ']' },\n            { 'open': '(', 'close': ')' },\n            { 'open': '`', 'close': '`' },\n            { 'open': '\"', 'close': '\"' },\n            { 'open': '$', 'close': '$' }\n        ]\n\n    };\n\n    registerTextmateLanguage(registry: TextmateRegistry): void {\n        monaco.languages.register({\n            id: this.TEX_LANGUAGE_ID,\n            'aliases': [\n                'LaTeX',\n                'latex'\n            ],\n            'extensions': [\n                '.tex'\n            ],\n            'mimetypes': [\n                'text/latex'\n            ]\n        });\n\n        monaco.languages.setLanguageConfiguration(this.TEX_LANGUAGE_ID, this.config);\n\n        const latexGrammar = require('../../data/LaTeX.tmLanguage.json');\n        registry.registerTextmateGrammarScope('text.tex.latex', {\n            async getGrammarDefinition(): Promise<GrammarDefinition> {\n                return {\n                    format: 'json',\n                    content: latexGrammar\n                };\n            }\n        });\n\n        registry.mapLanguageIdToTextmateGrammar(this.TEX_LANGUAGE_ID, 'text.tex.latex');\n    }\n}\n","export const LatexParserModule = (function() {\n    var PAGE_REGEX, HBOX_WARNING_REGEX, LATEX_WARNING_REGEX, LINES_REGEX, LOG_WRAP_LIMIT, LatexParser, LogText, PACKAGE_REGEX, PACKAGE_WARNING_REGEX, state;\n    LOG_WRAP_LIMIT = 79;\n    LATEX_WARNING_REGEX = /^LaTeX Warning: (.*)$/;\n    HBOX_WARNING_REGEX = /^(Over|Under)full \\\\(v|h)box/;\n    PACKAGE_WARNING_REGEX = /^(Package \\b.+\\b Warning:.*)$/;\n    LINES_REGEX = /lines? ([0-9]+)/;\n    PACKAGE_REGEX = /^Package (\\b.+\\b) Warning/;\n    PAGE_REGEX = /^Output written on \"?.*\\.[^ .\"]+\"? \\(([0-9]+) page/;\n    LogText = function(text) {\n        var i, wrappedLines;\n        this.text = text.replace(/(\\r\\n)|\\r/g, '\\n');\n        wrappedLines = this.text.split('\\n');\n        this.lines = [wrappedLines[0]];\n        i = 1;\n        while (i < wrappedLines.length) {\n            if (wrappedLines[i - 1].length === LOG_WRAP_LIMIT && wrappedLines[i - 1].slice(-3) !== '...') {\n                this.lines[this.lines.length - 1] += wrappedLines[i];\n            } else {\n                this.lines.push(wrappedLines[i]);\n            }\n            i++;\n        }\n        this.row = 0;\n    };\n    (function() {\n        this.nextLine = function() {\n            this.row++;\n            if (this.row >= this.lines.length) {\n                return false;\n            } else {\n                return this.lines[this.row];\n            }\n        };\n        this.rewindLine = function() {\n            this.row--;\n        };\n        this.linesUpToNextWhitespaceLine = function() {\n            return this.linesUpToNextMatchingLine(/^ *$/);\n        };\n        this.linesUpToNextMatchingLine = function(match) {\n            var lines, nextLine;\n            lines = [];\n            nextLine = this.nextLine();\n            if (nextLine !== false) {\n                lines.push(nextLine);\n            }\n            while (nextLine !== false && !nextLine.match(match) && nextLine !== false) {\n                nextLine = this.nextLine();\n                if (nextLine !== false) {\n                    lines.push(nextLine);\n                }\n            }\n            return lines;\n        };\n    }).call(LogText.prototype);\n    state = {\n        NORMAL: 0,\n        ERROR: 1\n    };\n    LatexParser = function(text, options) {\n        this.log = new LogText(text);\n        this.state = state.NORMAL;\n        options = options || {};\n        this.fileBaseNames = options.fileBaseNames || [/compiles/, /\\/usr\\/local/];\n        this.ignoreDuplicates = options.ignoreDuplicates;\n        this.data = [];\n        this.fileStack = [];\n        this.currentFileList = this.rootFileList = [];\n        this.openParens = 0;\n    };\n    (function() {\n        this.parse = function() {\n            var lineNo;\n            while ((this.currentLine = this.log.nextLine()) !== false) {\n                if (this.state === state.NORMAL) {\n                    if (this.currentLineIsError()) {\n                        this.state = state.ERROR;\n                        this.currentError = {\n                            line: null,\n                            file: this.currentFilePath,\n                            level: 'error',\n                            message: this.currentLine.slice(2),\n                            content: '',\n                            raw: this.currentLine + '\\n'\n                        };\n                    } else if (this.currentLineIsPageNumber()) {\n                        this.parsePageNumber();\n                    } else if (this.currentLineIsRunawayArgument()) {\n                        this.parseRunawayArgumentError();\n                    } else if (this.currentLineIsWarning()) {\n                        this.parseSingleWarningLine(LATEX_WARNING_REGEX);\n                    } else if (this.currentLineIsHboxWarning()) {\n                        this.parseHboxLine();\n                    } else if (this.currentLineIsPackageWarning()) {\n                        this.parseMultipleWarningLine();\n                    } else {\n                        this.parseParensForFilenames();\n                    }\n                }\n                if (this.state === state.ERROR) {\n                    this.currentError.content += this.log.linesUpToNextMatchingLine(/^l\\.[0-9]+/).join('\\n');\n                    this.currentError.content += '\\n';\n                    this.currentError.content += this.log.linesUpToNextWhitespaceLine().join('\\n');\n                    this.currentError.content += '\\n';\n                    this.currentError.content += this.log.linesUpToNextWhitespaceLine().join('\\n');\n                    this.currentError.raw += this.currentError.content;\n                    lineNo = this.currentError.raw.match(/l\\.([0-9]+)/);\n                    if (lineNo) {\n                        this.currentError.line = parseInt(lineNo[1], 10);\n                    }\n                    this.data.push(this.currentError);\n                    this.state = state.NORMAL;\n                }\n            }\n            return this.postProcess(this.data);\n        };\n        this.currentLineIsError = function() {\n            return this.currentLine[0] === '!';\n        };\n        this.currentLineIsRunawayArgument = function() {\n            return this.currentLine.match(/^Runaway argument/);\n        };\n        this.currentLineIsPageNumber = function() {\n            return this.currentLine.match('^Output written on');\n        };\n        this.currentLineIsWarning = function() {\n            return !!this.currentLine.match(LATEX_WARNING_REGEX);\n        };\n        this.currentLineIsPackageWarning = function() {\n            return !!this.currentLine.match(PACKAGE_WARNING_REGEX);\n        };\n        this.currentLineIsHboxWarning = function() {\n            return !!this.currentLine.match(HBOX_WARNING_REGEX);\n        };\n        this.parseRunawayArgumentError = function() {\n            var lineNo;\n            this.currentError = {\n                line: null,\n                file: this.currentFilePath,\n                level: 'error',\n                message: this.currentLine,\n                content: '',\n                raw: this.currentLine + '\\n'\n            };\n            this.currentError.content += this.log.linesUpToNextWhitespaceLine().join('\\n');\n            this.currentError.content += '\\n';\n            this.currentError.content += this.log.linesUpToNextWhitespaceLine().join('\\n');\n            this.currentError.raw += this.currentError.content;\n            lineNo = this.currentError.raw.match(/l\\.([0-9]+)/);\n            if (lineNo) {\n                this.currentError.line = parseInt(lineNo[1], 10);\n            }\n            return this.data.push(this.currentError);\n        };\n        this.parseSingleWarningLine = function(prefix_regex) {\n            var line, lineMatch, warning, warningMatch;\n            warningMatch = this.currentLine.match(prefix_regex);\n            if (!warningMatch) {\n                return;\n            }\n            warning = warningMatch[1];\n            lineMatch = warning.match(LINES_REGEX);\n            line = lineMatch ? parseInt(lineMatch[1], 10) : null;\n            this.data.push({\n                line: line,\n                file: this.currentFilePath,\n                level: 'warning',\n                message: warning,\n                raw: warning\n            });\n        };\n        this.parseMultipleWarningLine = function() {\n            var line, lineMatch, packageMatch, packageName, prefixRegex, raw_message, warningMatch, warning_lines;\n            warningMatch = this.currentLine.match(PACKAGE_WARNING_REGEX);\n            if (!warningMatch) {\n                return;\n            }\n            warning_lines = [warningMatch[1]];\n            lineMatch = this.currentLine.match(LINES_REGEX);\n            line = lineMatch ? parseInt(lineMatch[1], 10) : null;\n            packageMatch = this.currentLine.match(PACKAGE_REGEX);\n            packageName = packageMatch[1];\n            prefixRegex = new RegExp('(?:\\\\(' + packageName + '\\\\))*[\\\\s]*(.*)', 'i');\n            while (!!(this.currentLine = this.log.nextLine())) {\n                lineMatch = this.currentLine.match(LINES_REGEX);\n                line = lineMatch ? parseInt(lineMatch[1], 10) : line;\n                warningMatch = this.currentLine.match(prefixRegex);\n                warning_lines.push(warningMatch[1]);\n            }\n            raw_message = warning_lines.join(' ');\n            this.data.push({\n                line: line,\n                file: this.currentFilePath,\n                level: 'warning',\n                message: raw_message,\n                raw: raw_message\n            });\n        };\n        this.parseHboxLine = function() {\n            var line, lineMatch;\n            lineMatch = this.currentLine.match(LINES_REGEX);\n            line = lineMatch ? parseInt(lineMatch[1], 10) : null;\n            this.data.push({\n                line: line,\n                file: this.currentFilePath,\n                level: 'typesetting',\n                message: this.currentLine,\n                raw: this.currentLine\n            });\n        };\n        this.parsePageNumber = function() {\n            var line, lineMatch;\n            lineMatch = this.currentLine.match(PAGE_REGEX);\n            line = parseInt(lineMatch[1], 10);\n            this.data.push({\n                page: line,\n                file: this.currentFilePath,\n                level: 'pagenumber',\n                message: this.currentLine,\n                raw: this.currentLine\n            });\n        };\n        this.parseParensForFilenames = function() {\n            var filePath, newFile, pos, previousFile, token;\n            pos = this.currentLine.search(/\\(|\\)/);\n            if (pos !== -1) {\n                token = this.currentLine[pos];\n                this.currentLine = this.currentLine.slice(pos + 1);\n                if (token === '(') {\n                    filePath = this.consumeFilePath();\n                    if (filePath) {\n                        this.currentFilePath = filePath;\n                        newFile = {\n                            path: filePath,\n                            files: []\n                        };\n                        this.fileStack.push(newFile);\n                        this.currentFileList.push(newFile);\n                        this.currentFileList = newFile.files;\n                    } else {\n                        this.openParens++;\n                    }\n                } else if (token === ')') {\n                    if (this.openParens > 0) {\n                        this.openParens--;\n                    } else {\n                        if (this.fileStack.length > 1) {\n                            this.fileStack.pop();\n                            previousFile = this.fileStack[this.fileStack.length - 1];\n                            this.currentFilePath = previousFile.path;\n                            this.currentFileList = previousFile.files;\n                        }\n                    }\n                }\n                this.parseParensForFilenames();\n            }\n        };\n        this.consumeFilePath = function() {\n            var endOfFilePath, path;\n            if (!this.currentLine.match(/^\\/?([^ \\)]+\\/)+/)) {\n                return false;\n            }\n            endOfFilePath = this.currentLine.search(RegExp(' |\\\\)'));\n            path = void 0;\n            if (endOfFilePath === -1) {\n                path = this.currentLine;\n                this.currentLine = '';\n            } else {\n                path = this.currentLine.slice(0, endOfFilePath);\n                this.currentLine = this.currentLine.slice(endOfFilePath);\n            }\n            return path;\n        };\n        return this.postProcess = function(data) {\n            var all, errors, hashEntry, hashes, i, typesetting, warnings, pages;\n            all = [];\n            errors = [];\n            warnings = [];\n            typesetting = [];\n            pages = [];\n            hashes = [];\n            hashEntry = function(entry) {\n                return entry.raw;\n            };\n            i = 0;\n            while (i < data.length) {\n                if (this.ignoreDuplicates && hashes.indexOf(hashEntry(data[i])) > -1) {\n                    i++;\n                    continue;\n                }\n                if (data[i].level === 'error') {\n                    errors.push(data[i]);\n                } else if (data[i].level === 'typesetting') {\n                    typesetting.push(data[i]);\n                } else if (data[i].level === 'warning') {\n                    warnings.push(data[i]);\n                } else if (data[i].level === 'pagenumber') {\n                    pages.push(data[i]);\n                }\n\n                all.push(data[i]);\n                hashes.push(hashEntry(data[i]));\n                i++;\n            }\n            return {\n                pagenumber: pages,\n                errors: errors,\n                warnings: warnings,\n                typesetting: typesetting,\n                all: all,\n                files: this.rootFileList\n            };\n        };\n    }).call(LatexParser.prototype);\n    LatexParser.parse = function(text, options) {\n        return new LatexParser(text, options).parse();\n    };\n    return LatexParser;\n})();\n\nif (!global) global = {};\n(global['theia'] = global['theia'] || {})['@theia/latex/lib/browser/latex-log-parser'] = this;\n","/********************************************************************************\n* Copyright (C) 2019 Elliott Wen.\n*\n* This program and the accompanying materials are made available under the\n* terms of the Eclipse Public License v. 2.0 which is available at\n* http://www.eclipse.org/legal/epl-2.0.\n*\n* This Source Code may also be made available under the following Secondary\n* Licenses when the conditions for such availability set forth in the Eclipse\n* Public License v. 2.0 are satisfied: GNU General Public License, version 2\n* with the GNU Classpath Exception which is available at\n* https://www.gnu.org/software/classpath/license.html.\n*\n* SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n********************************************************************************/\n\nimport { BaseWidget, addEventListener } from '@theia/core/lib/browser/widgets/widget';\nimport { Key, KeyCode } from '@theia/core/lib/browser';\nimport '../../src/browser/style/index.css';\nimport { parseXDV } from './xdv-parser';\nimport { XDVMachine } from './xdv-machine';\nimport { Emitter, Event } from '@theia/core';\nimport * as $ from 'jquery';\n\nexport interface PositionChangeEvent {\n\turl: string | undefined;\n\tcs: number;\n\tline: number;\n\tcolumn: number;\n}\n\nexport class LaTeXPreviewWidget extends BaseWidget {\n\n\tprivate xdvBuffer: Uint8Array | undefined = undefined;\n\n\tprivate currentPage: number = 1;\n\n\tprivate totalPage: number = 1;\n\n\tprivate user_zoom_ratio: number = 1.0;\n\n\tprivate initFromViewer: boolean = false;\n\n\tprivate cachedFileList: string[] = [];\n\n\tprotected readonly onDidChangePositionEmitter = new Emitter<PositionChangeEvent>();\n\n\tconstructor(\n\n\t) {\n\t\tsuper();\n\t\tthis.toDispose.push(this.onDidChangePositionEmitter);\n\t\tthis.setupViewer();\n\t\tthis.update();\n\t}\n\n\tdispose(): void {\n\t\tthis.toDispose.dispose();\n\t}\n\n\tget onDidChangePosition(): Event<PositionChangeEvent> {\n\t\treturn this.onDidChangePositionEmitter.event;\n\t}\n\n\tprivate createButton(parent: HTMLElement, title: string, ...className: string[]): HTMLElement {\n\t\tconst button = document.createElement('div');\n\t\tbutton.title = title;\n\t\tbutton.classList.add(...className, 'swiftlatex-preview-toolbar-button');\n\t\tparent.appendChild(button);\n\t\treturn button;\n\t}\n\n\tprivate setupViewer(): void {\n\t\t/* self */\n\t\tthis.title.label = 'preview';\n\t\tthis.title.caption = this.title.label;\n\t\tthis.title.closable = false;\n\t\tthis.id = 'latex-preview';\n\t\tthis.title.iconClass = 'fa fa-eye';\n\t\tthis.addClass('swiftlatex-preview-widget');\n\t\tthis.node.tabIndex = 0;\n\t\tconst parent = this.node;\n\n\t\t/* toolbar */\n\t\tconst toolbar = document.createElement('div');\n\t\ttoolbar.classList.add('swiftlatex-preview-toolbar');\n\t\tparent.appendChild(toolbar);\n\t\t/* toolbar buttons */\n\t\tconst previous_btn = this.createButton(toolbar, 'Show The Previous Page', 'swiftlatex-preview-toolbar-previous');\n\t\tthis.toDispose.push(addEventListener(previous_btn, 'click', this.handleBack.bind(this)));\n\t\tconst next_btn = this.createButton(toolbar, 'Show The Next Page', 'swiftlatex-preview-toolbar-next');\n\t\tthis.toDispose.push(addEventListener(next_btn, 'click', this.handleForward.bind(this)));\n\t\tconst zoomin_btn = this.createButton(toolbar, 'Zoom In', 'swiftlatex-preview-toolbar-zoomin');\n\t\tthis.toDispose.push(addEventListener(zoomin_btn, 'click', this.handleZoomin.bind(this)));\n\t\tconst zoomout_btn = this.createButton(toolbar, 'Zoom Out', 'swiftlatex-preview-toolbar-zoomout');\n\t\tthis.toDispose.push(addEventListener(zoomout_btn, 'click', this.handleZoomOut.bind(this)));\n\t\t/* toolbar input */\n\t\tconst input = document.createElement('input');\n\t\tinput.type = 'text';\n\t\tinput.id = 'swiftlatex-preview-pagecontrol';\n\t\tinput.classList.add('swiftlatex-preview-toolbar-input');\n\t\tthis.toDispose.push(addEventListener(input, 'keydown', this.handleInputChanged.bind(this)));\n\t\ttoolbar.appendChild(input);\n\t\t/* Viewer area, maintained by cashdom/jquery */\n\t\tconst viewer = document.createElement('div');\n\t\tviewer.id = 'swiftlatex_preview_viewer';\n\t\tparent.appendChild(viewer);\n\t}\n\n\tpublic updateXDV(buffer: Uint8Array): void {\n\t\tthis.xdvBuffer = buffer;\n\t\tthis.showPage();\n\t}\n\n\tprivate handleBack(): void {\n\t\tif (this.currentPage - 1 >= 1) {\n\t\t\tthis.currentPage -= 1;\n\t\t\tthis.showPage();\n\t\t}\n\t}\n\n\tprivate handleZoomin(): void {\n\t\tconsole.log('Zoom in');\n\t\tthis.user_zoom_ratio = this.user_zoom_ratio + 0.1;\n\t\tthis.doZoom();\n\t}\n\n\tprivate doZoom(): void {\n\t\tconst viewer = $('.page_decoration');\n\t\tviewer.css('-webkit-transform', `scale(${this.user_zoom_ratio})`);\n\t\tviewer.css('-ms-transform', `scale(${this.user_zoom_ratio})`);\n\t\tviewer.css('-transform', `scale(${this.user_zoom_ratio})`);\n\t}\n\n\tprivate handleZoomOut(): void {\n\t\tconsole.log('Zoom Out');\n\t\tthis.user_zoom_ratio = this.user_zoom_ratio - 0.1;\n\t\tthis.doZoom();\n\t}\n\n\tprivate handleForward(): void {\n\t\tif (this.currentPage + 1 <= this.totalPage) {\n\t\t\tthis.currentPage += 1;\n\t\t\tthis.showPage();\n\t\t}\n\t}\n\n\tprivate showPage(): void {\n\t\tif (this.xdvBuffer) {\n\t\t\tconst xdvMachine = new XDVMachine();\n\t\t\tlet parse_ok = false;\n\t\t\ttry {\n\t\t\t\tparseXDV(this.xdvBuffer, xdvMachine, this.currentPage);\n\t\t\t\tparse_ok = true;\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t\t/* Handle Error */\n\t\t\t}\n\n\t\t\tif (!parse_ok) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.cachedFileList = xdvMachine.fileList;\n\t\t\tthis.totalPage = xdvMachine.totalPages;\n\t\t\tconst htmlContent = xdvMachine.getBody();\n\t\t\tconst styleContent = '<style>' + xdvMachine.getStyle() + '</style>\\n';\n\t\t\tthis.unbindEvents();\n\t\t\t$('#swiftlatex_preview_viewer').html('');\n\t\t\t$('#swiftlatex_preview_viewer').append(styleContent);\n\t\t\t$('#swiftlatex_preview_viewer').append(htmlContent);\n\t\t\tthis.doZoom();\n\t\t\tthis.bindEvents();\n\t\t\tthis.doShowPageNumber();\n\t\t}\n\t}\n\n\tprivate unbindEvents(): void {\n\t\t$('.pf-line > span').off();\n\t}\n\n\tprivate bindEvents(): void {\n\t\t$('.pf-line > span').on('click', event_obj => {\n\t\t\tthis.initFromViewer = true;\n\t\t\tconst span_obj = $(event_obj.target);\n\t\t\tconst beforeOrAfter = event_obj.pageX > span_obj.offset()!.left + span_obj.width()! / 2;\n\t\t\tthis.doShowCursor(span_obj, beforeOrAfter);\n\t\t});\n\t}\n\n\tprivate clearCursor(): void {\n\t\t$('.viewercursor').remove();\n\t}\n\n\tprivate doShowCursor(span_obj: JQuery<HTMLElement>, beforeOrAfter: boolean): void {\n\t\tthis.clearCursor();\n\t\t// const is_space = span_obj.hasClass('pf-space');\n\t\tif (this.getRow(span_obj) !== 0) {\n\t\t\tif (this.getEcs(span_obj) === 0) {\n\t\t\t\tconst cursor_html = `<span class='viewercursor' l=${this.getRow(span_obj)} c=${this.getCol(span_obj) + 1} f=${this.getFid(span_obj)}></span>`;\n\t\t\t\tif (beforeOrAfter) {\n\t\t\t\t\tspan_obj.after(cursor_html);\n\t\t\t\t} else {\n\t\t\t\t\tspan_obj.before(cursor_html);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* Fire event */\n\t\t\tif (this.initFromViewer) {\n\t\t\t\tthis.onDidChangePositionEmitter.fire({\n\t\t\t\t\tline: this.getRow(span_obj),\n\t\t\t\t\tcolumn: this.getCol(span_obj),\n\t\t\t\t\turl: this.fidToUrl(this.getFid(span_obj)),\n\t\t\t\t\tcs: this.getEcs(span_obj)\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate handleInputChanged(e: KeyboardEvent): void {\n\t\tif (!this.xdvBuffer) {\n\t\t\treturn;\n\t\t}\n\t\tconst { key } = KeyCode.createKeyCode(e);\n\t\tif (key && Key.ENTER.keyCode === key.keyCode) {\n\t\t\tconst { srcElement } = e;\n\t\t\tif (srcElement instanceof HTMLInputElement) {\n\t\t\t\tlet input_val: string = <string>$(srcElement).val();\n\t\t\t\tif (input_val.includes('/')) {\n\t\t\t\t\tinput_val = input_val.split('/')[0];\n\t\t\t\t}\n\t\t\t\tconst vv = parseInt(input_val);\n\t\t\t\tif (!isNaN(vv)) {\n\t\t\t\t\tif ((vv >= 1 && vv <= this.totalPage) && vv !== this.currentPage) {\n\t\t\t\t\t\tthis.currentPage = vv;\n\t\t\t\t\t\tthis.showPage();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.doShowPageNumber();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate doShowPageNumber(): void {\n\t\t$('#swiftlatex-preview-pagecontrol').val(`${this.currentPage}/${this.totalPage}`);\n\t}\n\n\tprivate getRow(obj: JQuery<HTMLElement>): number {\n\t\tconst inp = obj.attr('l');\n\t\tif (!inp) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn parseInt(inp);\n\t};\n\n\tprivate getCol(obj: JQuery<HTMLElement>): number {\n\t\tconst inp = obj.attr('c');\n\t\tif (!inp) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn parseInt(inp);\n\t};\n\n\tprivate getEcs(obj: JQuery<HTMLElement>): number {\n\t\tconst inp = obj.attr('cs');\n\t\tif (!inp) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn parseInt(inp);\n\t};\n\n\tprivate getFid(obj: JQuery<HTMLElement>): number {\n\t\tconst inp = obj.attr('f');\n\t\tif (!inp) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn parseInt(inp);\n\t};\n\n\tprivate fidToUrl(fid: number): string | undefined {\n\t\tif (fid > this.cachedFileList.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this.cachedFileList[fid - 1];\n\t}\n\n\tprivate urlToFid(url: string): number {\n\t\tfor (let j = 0; j < this.cachedFileList.length; j++) {\n\t\t\tif (this.cachedFileList[j] === url) {\n\t\t\t\treturn j + 1;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\n\tprivate isCursorShowing(): boolean {\n\t\treturn ($('.viewercursor').length === 1);\n\t}\n\n\tpublic handleEditorCursorMoved(line: number, column: number, uri: string): void {\n\t\tthis.initFromViewer = false;\n\t\tif (uri.startsWith('file:///')) {\n\t\t\turi = uri.substr(8);\n\t\t}\n\t\tconst fid = this.urlToFid(uri);\n\t\tif (fid === -1) {\n\t\t\treturn;\n\t\t}\n\n\t\t/* Compatiablilty */\n\t\tline += 1;\n\n\t\tif (this.isCursorShowing()) {\n\t\t\t/* Todo Consider Adding It */\n\t\t\tconst cursorObj = $('.viewercursor');\n\t\t\tconst orirow = this.getRow(cursorObj);\n\t\t\tconst oricol = this.getCol(cursorObj);\n\t\t\tconst orifid = this.getFid(cursorObj);\n\t\t\t/* Cursor is always one bit ahead */\n\t\t\tif (orirow === line && oricol === column + 1 && orifid === fid) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.clearCursor();\n\t\t}\n\n\t\tconsole.log(`looking for span[l='${line}' c='${column}' f='${fid}']`);\n\t\tconst candicates = $(`.pf-line > span[l='${line}']`);\n\t\tconst filteredOnes: JQuery<HTMLElement>[] = [];\n\t\tcandicates.each((index, element) => {\n\t\t\tconst elementJquery = $(element);\n\t\t\tif (this.getCol(elementJquery) === column && this.getEcs(elementJquery) === 0 && this.getFid(elementJquery) === fid) {\n\t\t\t\tfilteredOnes.push(elementJquery);\n\t\t\t}\n\t\t});\n\n\t\tif (filteredOnes.length > 0) {\n\t\t\tthis.doShowCursor(filteredOnes[0], true);\n\t\t\treturn;\n\t\t}\n\n\t\tlet min_distance = 0xffff;\n\t\tlet heuristElement: JQuery<HTMLElement> | undefined = undefined;\n\t\tlet beforeOrAfter = true;\n\t\tcandicates.each((index, element) => {\n\t\t\tconst elementJquery = $(element);\n\t\t\tif (this.getEcs(elementJquery) !== 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.getFid(elementJquery) !== fid) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst distance = this.getCol(elementJquery) - column;\n\t\t\tif (Math.abs(distance) <= min_distance) {\n\t\t\t\tmin_distance = Math.abs(distance);\n\t\t\t\theuristElement = elementJquery;\n\t\t\t\tbeforeOrAfter = !(distance > 0);\n\t\t\t}\n\t\t});\n\n\t\tif (heuristElement !== undefined && heuristElement!.length > 0) {\n\t\t\tthis.doShowCursor(heuristElement, beforeOrAfter);\n\t\t}\n\t}\n\n\tpublic handleCharacterInserted(nchar: string): void {\n\t\tthis.initFromViewer = false;\n\t\tif (!this.isCursorShowing()) {\n\t\t\treturn;\n\t\t}\n\t\tconst cursorObj = $('.viewercursor');\n\t\tconst orirow = this.getRow(cursorObj);\n\t\tconst oricol = this.getCol(cursorObj);\n\t\tconst orifid = this.getFid(cursorObj);\n\n\t\tif (nchar === ' ') {\n\t\t\tnchar = '&nbsp';\n\t\t}\n\t\tcursorObj.before(`<span l=${orirow} c=${oricol} f=${orifid} cs=0>${nchar}</span>`);\n\t\tcursorObj.attr('c', oricol + 1);\n\n\t\t/* Fix the following */\n\t\tlet nextobj = cursorObj;\n\t\tlet stepCount = 0;\n\t\twhile (stepCount < 255) {\n\t\t\tstepCount += 1;\n\t\t\tnextobj = nextobj.next();\n\t\t\tif (nextobj.length === 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tconst tmpcol = this.getCol(nextobj) + 1;\n\t\t\tnextobj.attr('c', tmpcol);\n\t\t}\n\t}\n\n\tpublic handleCharacterDeleted(nchar: string): void {\n\n\t\tthis.initFromViewer = false;\n\t\tif (!this.isCursorShowing()) {\n\t\t\treturn;\n\t\t}\n\t\tconst cursorObj = $('.viewercursor');\n\t\tconst oricol = this.getCol(cursorObj);\n\n\t\tif (oricol === 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst prevspan = cursorObj.prev();\n\t\tif (prevspan.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet isRemoved = false;\n\t\tif (nchar === ' ' && prevspan.hasClass('pf-space')) {\n\t\t\tprevspan.remove();\n\t\t\tisRemoved = true;\n\t\t} else if (prevspan.html() === nchar) {\n\t\t\tprevspan.remove();\n\t\t\tisRemoved = true;\n\t\t}\n\t\t/* Fix the following */\n\t\tif (isRemoved) {\n\t\t\tlet nextobj = cursorObj;\n\t\t\tlet stepCount = 0;\n\t\t\twhile (stepCount < 255) {\n\t\t\t\tstepCount += 1;\n\t\t\t\tnextobj = nextobj.next();\n\t\t\t\tif (nextobj.length === 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tconst tmpcol = this.getCol(nextobj) - 1;\n\t\t\t\tnextobj.attr('c', tmpcol);\n\t\t\t}\n\t\t}\n\t}\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { MonacoEditorModel } from '@theia/monaco/lib/browser/monaco-editor-model';\nimport * as Y from 'yjs';\nimport { WebsocketProvider } from 'y-websocket';\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst createMutex = () => {\n\tlet token = true;\n\treturn (f: any, g: any) => {\n\t\tif (token) {\n\t\t\ttoken = false;\n\t\t\ttry {\n\t\t\t\tf();\n\t\t\t} finally {\n\t\t\t\ttoken = true;\n\t\t\t};\n\t\t} else if (g !== undefined) {\n\t\t\tg();\n\t\t};\n\t};\n};\n\nexport class MonacoYJSBinding {\n\tprivate mux: any;\n\tprivate monacoHander: monaco.IDisposable;\n\tprivate hasInited: boolean = false; /* Prevent multiple sync events */\n\tconstructor(protected monacoModel: MonacoEditorModel) {\n\t\tthis.mux = createMutex();\n\t\tthis.init_yjs(monacoModel.textEditorModel);\n\t}\n\n\tinit_yjs(monacoModel: monaco.editor.IModel): void {\n\t\tconsole.log('Opening url ' + monacoModel.uri.toString());\n\t\tconst ydoc = new Y.Doc();\n\t\tconst unique_id = (window.location.pathname + monacoModel.uri.toString()).replace(/\\//gm, '_').replace(':', '_').replace(/\\./gm, '_');\n\t\tconst provider = new WebsocketProvider('wss://share.swiftlatex.com', unique_id, ydoc);\n\t\tconst ytext = ydoc.getText('document');\n\n\t\tprovider.on('sync', () => {\n\t\t\tif (this.hasInited) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.hasInited = true;\n\t\t\tconst remote_source = ytext.toString();\n\t\t\tconst local_source = monacoModel.getValue();\n\t\t\tif (remote_source === local_source) {\n\t\t\t\tconsole.log('All synced');\n\t\t\t} else {\n\t\t\t\tif (remote_source.length === 0) {\n\t\t\t\t\tytext.insert(0, local_source);\n\t\t\t\t\tconsole.log('Using local source');\n\t\t\t\t} else {\n\t\t\t\t\tmonacoModel.setValue(remote_source);\n\t\t\t\t\tconsole.log('Trusting remote source');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconsole.log('Start binding editor events');\n\t\t\tthis.monacoHander = monacoModel.onDidChangeContent(event => {\n\t\t\t\tthis.mux(() => {\n\t\t\t\t\tydoc!.transact(() => {\n\t\t\t\t\t\tevent.changes.sort((change1, change2) => change2.rangeOffset - change1.rangeOffset).forEach(change => {\n\t\t\t\t\t\t\tytext.delete(change.rangeOffset, change.rangeLength);\n\t\t\t\t\t\t\tytext.insert(change.rangeOffset, change.text);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, this);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconsole.log('Start binding yjs events');\n\t\t\tytext.observe(event => {\n\t\t\t\tthis.mux(() => {\n\t\t\t\t\tlet index = 0;\n\t\t\t\t\tevent.delta.forEach(op => {\n\t\t\t\t\t\tif (op.retain !== undefined) {\n\t\t\t\t\t\t\tindex += op.retain;\n\t\t\t\t\t\t} else if ((<any>op).insert !== undefined) {\n\t\t\t\t\t\t\tconst pos = monacoModel.getPositionAt(index);\n\t\t\t\t\t\t\tconst range = new monaco.Selection(pos.lineNumber, pos.column, pos.lineNumber, pos.column);\n\t\t\t\t\t\t\t/* eslint-disable */\n\t\t\t\t\t\t\tmonacoModel.pushEditOperations([], [{ range, text: (<any>op).insert }], () => null);\n\t\t\t\t\t\t\tindex += (<any>op).insert.length;\n\t\t\t\t\t\t\t/* eslint-enable */\n\t\t\t\t\t\t} else if (op.delete !== undefined) {\n\t\t\t\t\t\t\tconst pos = monacoModel.getPositionAt(index);\n\t\t\t\t\t\t\tconst endPos = monacoModel.getPositionAt(index + op.delete);\n\t\t\t\t\t\t\tconst range = new monaco.Selection(pos.lineNumber, pos.column, endPos.lineNumber, endPos.column);\n\t\t\t\t\t\t\t/* eslint-disable */\n\t\t\t\t\t\t\tmonacoModel.pushEditOperations([], [{ range, text: '' }], () => null);\n\t\t\t\t\t\t\t/* eslint-enable */\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow Error('Unexpected sync protocol');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tmonacoModel.pushStackElement();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tmonacoModel.onWillDispose(() => {\n\t\t\t/* To debounce */\n\t\t\tthis.hasInited = true;\n\t\t\tconsole.log('Disposing editor event handlers');\n\t\t\tif (this.monacoHander) {\n\t\t\t\tthis.monacoHander.dispose();\n\t\t\t}\n\t\t\tytext._eH.l.length = 0;\n\t\t\tydoc.destroy();\n\t\t\t// provider.disconnect();\n\t\t\tprovider.destroy();\n\t\t});\n\n\t\tprovider.connect();\n\t}\n}\n","/********************************************************************************\n * Copyright (C) 2019 Elliott Wen.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable, inject } from 'inversify';\n\nimport { Command, CommandContribution, CommandRegistry, MenuContribution, MenuModelRegistry, MessageService } from '@theia/core/lib/common';\nimport { MAIN_MENU_BAR, DisposableCollection } from '@theia/core';\nimport { LaTeXEngine } from './latex-engine';\nimport { XDVExporter } from './xdv-exporter';\nimport { S3StorageSystem } from '@theia/filesystem/lib/browser/s3storagesystem';\nimport { getDocument } from 'pdfjs-dist';\nimport { MonacoWorkspace, MonacoDidChangeTextDocumentParams } from '@theia/monaco/lib/browser/monaco-workspace';\nimport { MonacoEditorModel } from '@theia/monaco/lib/browser/monaco-editor-model';\nimport { MonacoYJSBinding } from './monaco-yjs';\nimport { OutputChannelManager, OutputChannel } from '@theia/output/lib/common/output-channel';\nimport { ProblemManager } from '@theia/markers/lib/browser/problem/problem-manager';\nimport { Diagnostic } from '@theia/languages/lib/browser';\nimport { LatexParserModule } from './latex-log-parser';\nimport { FileSystemWatcher, FileChangeEvent } from '@theia/filesystem/lib/browser/filesystem-watcher';\nimport URI from '@theia/core/lib/common/uri';\nimport { FrontendApplication, OpenerService, open } from '@theia/core/lib/browser';\nimport { LaTeXPreviewWidget } from './latex-preview-widget';\nimport { UriAwareCommandHandler } from '@theia/core/lib/common/uri-command-handler';\nimport { SelectionService } from '@theia/core/lib/common/selection-service';\nimport { NavigatorContextMenu } from '@theia/navigator/lib/browser/navigator-contribution';\nimport { EditorManager } from '@theia/editor/lib/browser';\nimport { OutputContribution } from '@theia/output/lib/browser/output-contribution';\nimport { DiffMatchPatch } from 'diff-match-patch-typescript';\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nexport namespace LaTeXMenus {\n    export const LATEX = [...MAIN_MENU_BAR, '7_latex'];\n    export const LATEX_QUICK_BUILD = [...LATEX, '1_latex'];\n    export const LATEX_BUILD = [...LATEX, '1_latex'];\n    export const LATEX_EXPORT = [...LATEX, '1_latex'];\n    export const LATEX_CLEAN = [...LATEX, '2_latex'];\n    export const ENGINE_RESTART = [...LATEX, '2_latex'];\n}\n\nexport namespace LaTeXCommands {\n    const LATEX_CATEGORY = 'LaTeX';\n    export const BUILD_QUICK: Command = {\n        id: 'latex:quickbuild',\n        category: LATEX_CATEGORY,\n        label: 'Preview'\n    };\n    export const BUILD_LINK: Command = {\n        id: 'latex:build',\n        category: LATEX_CATEGORY,\n        label: 'Compile'\n    };\n    export const PROJECT_EXPORT: Command = {\n        id: 'latex:export',\n        category: LATEX_CATEGORY,\n        label: 'Export PDF'\n    };\n    export const PROJECT_CLEAN: Command = {\n        id: 'latex:clean',\n        category: LATEX_CATEGORY,\n        label: 'Clean Project'\n    };\n    export const ENGINE_RESTART: Command = {\n        id: 'latex:restart',\n        category: LATEX_CATEGORY,\n        label: 'Restart Engine'\n    };\n    export const ENGINE_SET_ENTRY: Command = {\n        id: 'latex:setentry',\n        category: LATEX_CATEGORY,\n        label: 'Set Main Entry File'\n    };\n}\n\n@injectable()\nexport class LaTeXMenuContribution implements MenuContribution {\n\n    registerMenus(menus: MenuModelRegistry): void {\n        menus.registerSubmenu(LaTeXMenus.LATEX, 'LaTeX');\n        menus.registerMenuAction(LaTeXMenus.LATEX_QUICK_BUILD, {\n            commandId: LaTeXCommands.BUILD_QUICK.id,\n            order: '0'\n        });\n        menus.registerMenuAction(LaTeXMenus.LATEX_BUILD, {\n            commandId: LaTeXCommands.BUILD_LINK.id,\n            order: '1'\n        });\n        menus.registerMenuAction(LaTeXMenus.LATEX_EXPORT, {\n            commandId: LaTeXCommands.PROJECT_EXPORT.id,\n            order: '2'\n        });\n        menus.registerMenuAction(LaTeXMenus.LATEX_CLEAN, {\n            commandId: LaTeXCommands.PROJECT_CLEAN.id,\n            order: '3'\n        });\n        menus.registerMenuAction(LaTeXMenus.ENGINE_RESTART, {\n            commandId: LaTeXCommands.ENGINE_RESTART.id,\n            order: '4'\n        });\n\n        /* Navigator  */\n        menus.registerMenuAction(NavigatorContextMenu.CLIPBOARD, {\n            commandId: LaTeXCommands.ENGINE_SET_ENTRY.id,\n            order: 'z'\n        });\n    }\n}\n\nconst RETRY_INTERVAL = 2000;\n\ninterface EditContext {\n    text: string;\n    line: number;\n    column: number;\n    uri: string;\n}\n\n@injectable()\nexport class LaTeXCommandContribution implements CommandContribution {\n\n    private cachedXDV: Uint8Array | undefined = undefined;\n    private hasFileSyncedToEngine: boolean = false;\n    protected readonly toDispose = new DisposableCollection();\n    protected readonly toDisposePerEditor = new DisposableCollection();\n    private readonly opened_yjs_handles: Map<string, number> = new Map<string, number>();\n    private output_channel: OutputChannel;\n    private preview_widget: LaTeXPreviewWidget;\n    private lastCompileTime: number = 0;\n    private retryHandle: number = -1;\n    private savedEditContext: EditContext | undefined = undefined;\n\n    constructor(\n        @inject(S3StorageSystem) private readonly s3filesystem: S3StorageSystem,\n        @inject(MessageService) private readonly messageService: MessageService,\n        @inject(LaTeXEngine) private readonly latexEngine: LaTeXEngine,\n        @inject(XDVExporter) private readonly xdvExporter: XDVExporter,\n        @inject(MonacoWorkspace) private readonly workspace: MonacoWorkspace,\n        @inject(OutputChannelManager) protected readonly outputChannelManager: OutputChannelManager,\n        @inject(ProblemManager) protected readonly problemManager: ProblemManager,\n        @inject(FileSystemWatcher) protected readonly fileSystemWatcher: FileSystemWatcher,\n        @inject(FrontendApplication) protected readonly app: FrontendApplication,\n        @inject(SelectionService) protected readonly selectionService: SelectionService,\n        @inject(OpenerService) protected readonly openerService: OpenerService,\n        @inject(EditorManager) protected readonly editorManager: EditorManager,\n        @inject(OutputContribution) protected readonly outputContribution: OutputContribution,\n    ) {\n        this.toDispose.push(this.workspace.onDidOpenTextDocument(model => this.fireDidOpenDocument(model)));\n        this.toDispose.push(this.workspace.onDidChangeTextDocument(param => this.fireDidChangeContents(param)));\n        this.toDispose.push(this.workspace.onDidCloseTextDocument(model => this.fireDidCloseDocument(model)));\n        this.listenOnDirChange();\n        this.output_channel = this.outputChannelManager.getChannel('LaTeX');\n        this.preview_widget = new LaTeXPreviewWidget();\n        this.app.shell.addWidget(this.preview_widget, { area: 'right' });\n        this.bindPreviewWidgetEvents();\n    }\n\n    private bindPreviewWidgetEvents(): void {\n        /* Cursor Event from Preview Widget */\n        this.toDispose.push(this.preview_widget.onDidChangePosition(e => {\n            const openOptions = {\n                selection: {\n                    start: {\n                        line: e.line - 1,\n                        character: e.column - 1\n                    },\n                    end: {\n                        line: e.line - 1,\n                        character: e.column - 1\n                    }\n                }\n            };\n            open(this.openerService, new URI(e.url), openOptions).catch(err => {\n                /* Todo Handle Error */\n            });\n        }));\n\n        /* Cursor Event from Editor */\n        this.toDispose.push(this.editorManager.onCurrentEditorChanged(editorWidget => {\n            this.toDisposePerEditor.dispose();\n            if (editorWidget) {\n                const { editor } = editorWidget;\n                if (editor) {\n                    this.toDisposePerEditor.push(editor.onCursorPositionChanged(() => {\n                        const { cursor } = editor;\n                        const currentURI = editor.document.uri;\n                        this.preview_widget.handleEditorCursorMoved(cursor.line, cursor.character, currentURI);\n                        // console.log(`${cursor.line}-${cursor.character}-${currentURI}`);\n                    }));\n                }\n            }\n        }));\n    }\n\n    private getCurrentContext(): EditContext | undefined {\n        const currentEditorWidget = this.editorManager.currentEditor;\n        if (currentEditorWidget) {\n            const currentEditor = currentEditorWidget.editor;\n            if (currentEditor) {\n                const cursor = currentEditor.cursor;\n                const currentURI = currentEditor.document.uri;\n                const text = currentEditor.document.getLineContent(cursor.line);\n                return {\n                    line: cursor.line,\n                    column: cursor.character,\n                    uri: currentURI,\n                    text: text\n                };\n            }\n        }\n        console.log('Fail to get context?');\n        return undefined;\n    }\n\n    private generateContextPatch(saved: EditContext, current: EditContext): string {\n        if (saved.line === current.line) {\n            const dmp = new DiffMatchPatch();\n            const diff = dmp.diff_main(saved.text, current.text);\n            let delcount = 0;\n            let inscount = 0;\n            let inscontent = '';\n            let delcontent = '';\n            for (const tindex in diff) {\n                if (diff[tindex][0] === 1) {\n                    inscount += 1;\n                    inscontent += diff[tindex][1];\n                } else if (diff[tindex][0] === -1) {\n                    delcount += 1;\n                    delcontent += diff[tindex][1];\n                }\n            }\n            if (inscount === 1 && delcount === 0) {\n                return '+' + inscontent;\n            } else if (inscount === 0 && delcount === 1) {\n                return '-' + delcontent.split('').reverse().join('');\n            }\n        }\n        return '';\n    }\n\n    public applyContextPatch(patch: string): void {\n        if (patch.startsWith('+')) {\n            for (let tmpk = 1; tmpk < patch.length; tmpk++) {\n                this.preview_widget.handleCharacterInserted(patch[tmpk]);\n            }\n        } else if (patch.startsWith('-')) {\n            for (let tmpk = 1; tmpk < patch.length; tmpk++) {\n                this.preview_widget.handleCharacterDeleted(patch[tmpk]);\n            }\n        }\n    }\n\n    registerCommands(registry: CommandRegistry): void {\n        registry.registerCommand(LaTeXCommands.BUILD_QUICK, {\n            execute: () => this.quickBuild(true),\n            isEnabled: () => this.latexEngine.isReady(),\n        });\n        registry.registerCommand(LaTeXCommands.BUILD_LINK, {\n            execute: () => this.fullBuild(),\n            isEnabled: () => this.latexEngine.isReady(),\n        });\n        registry.registerCommand(LaTeXCommands.PROJECT_EXPORT, {\n            execute: () => this.exportPDF(),\n            isEnabled: () => this.latexEngine.isReady() && this.cachedXDV !== undefined\n        });\n        registry.registerCommand(LaTeXCommands.PROJECT_CLEAN, {\n            execute: () => this.cleanProject(),\n            isEnabled: () => this.latexEngine.isReady(),\n        });\n        registry.registerCommand(LaTeXCommands.ENGINE_RESTART, {\n            execute: () => this.restartEngine()\n        });\n        registry.registerCommand(\n            LaTeXCommands.ENGINE_SET_ENTRY,\n            new UriAwareCommandHandler<URI>(this.selectionService, {\n                execute: uris => this.setMainFile(uris),\n                isEnabled: uris => this.canSetAsMainFile(uris),\n            }, { multi: false })\n        );\n    }\n\n    protected async quickBuild(shouldShowPreviewWidget: boolean = false): Promise<boolean> {\n\n        if (!this.latexEngine.isReady()) {\n            return false;\n        }\n\n        const mainTempFiles = await this.resolveMainFile();\n        if (mainTempFiles.length === 0) {\n            this.messageService.error('Cannot locate the main LaTeX entry file. Please create a main entry file in root directory before compilation.', { timeout: 15000 });\n            return false;\n        }\n\n        if (mainTempFiles.length > 1) {\n            this.messageService.error(`Compiler cannot tell which file is the main entry file, either ${mainTempFiles[0]} or ${mainTempFiles[1]}.`, { timeout: 15000 });\n            return false;\n        }\n\n        if (!this.hasFileSyncedToEngine) {\n            this.hasFileSyncedToEngine = true;\n            await this._syncFileToEngine('/');\n        }\n\n        // this.messageService.info('Building preview', { timeout: 3000 });\n        this.latexEngine.setEngineMainFile(mainTempFiles[0]);\n\n        /* Todo */\n        this.savedEditContext = this.getCurrentContext();\n        const compileResult = await this.latexEngine.compileLaTeX();\n\n        /* Write log to output and parse log */\n        this.processCompileLog(compileResult.log);\n        if (compileResult.status === 1 || compileResult.status === 0) {\n            /* Successful compilation */\n            this.cachedXDV = compileResult.pdf;\n            this.preview_widget.updateXDV(this.cachedXDV!);\n            if (this.savedEditContext) {\n                const currentContext = this.getCurrentContext();\n                const patch = this.generateContextPatch(this.savedEditContext!, currentContext!);\n                console.log(patch);\n                this.preview_widget.handleEditorCursorMoved(this.savedEditContext!.line, this.savedEditContext!.column, this.savedEditContext!.uri);\n                this.applyContextPatch(patch);\n            }\n            if (shouldShowPreviewWidget) {\n                this.app.shell.revealWidget(this.preview_widget.id);\n            }\n            return true;\n        } else {\n            /* Failure, Probably showing log is more useful */\n            // this.messageService.error('A build error is detected, please check the engine output', { timeout: 15000 });\n            const activate = false;\n            const reveal = true;\n            await this.outputContribution.openView({ activate, reveal });\n            // console.log('error detected ' + compileResult.status);\n            return false;\n        }\n    }\n\n    private async processCompileLog(log: string): Promise<void> {\n        this.output_channel.clear();\n        this.output_channel.append(log);\n        const parseRes = LatexParserModule.parse(log);\n        const diags: Map<string, Diagnostic[]> = new Map<string, Diagnostic[]>();\n\n        const allStuff = parseRes.errors.concat(parseRes.warnings);\n\n        for (let j = 0; j < allStuff.length; j++) {\n            const error = allStuff[j];\n            let uri = error.file;\n            const diag: Diagnostic = {\n                range: {\n                    start: {\n                        line: error.line - 1,\n                        character: 0\n                    },\n                    end: {\n                        line: error.line - 1,\n                        character: 0\n                    }\n                },\n                message: error.message,\n                severity: error.level === 'error' ? 1 : 2\n            };\n\n            /* Log file has the format ./xxx/xxx.tex, convert to them to standard */\n            uri = uri.substr(1);\n            /* Main_entry_trick If file does not end with a tex, blame the main file */\n            if (!uri.endsWith('.tex')) {\n                const temps = await this.resolveMainFile();\n                uri = '/' + temps[0];\n            }\n            if (!diags.has(uri)) {\n                diags.set(uri, []);\n            }\n            diags.get(uri)!.push(diag);\n        }\n\n        diags.forEach((diag, key) => {\n            this.problemManager.setMarkers(new URI(key), 'Engine', diag);\n        });\n    }\n\n    private async _syncFileToEngine(url: string): Promise<void> {\n        const objs = await this.s3filesystem.readdir(url);\n        for (let j = 0; j < objs.length; j++) {\n            const obj = objs[j];\n            if (obj.isDir) {\n                if (obj.uri.includes('.swiftlatex') || obj.uri.includes('.theia')) {\n                    continue;\n                }\n                this.latexEngine.makeMemFSFolder(obj.uri);\n                await this._syncFileToEngine(obj.uri);\n            } else {\n                let content: Uint8Array | string = await this.s3filesystem.readFile(obj.uri);\n                if (obj.uri.endsWith('.pdf') || obj.uri.endsWith('.jpg')\n                    || obj.uri.endsWith('.png') || obj.uri.endsWith('.bmp')) {\n                    content = await this.measureImageDim(content, obj.uri);\n                }\n                this.latexEngine.writeMemFSFile(content, obj.uri);\n                console.log('Writing file to engine ' + obj.uri);\n            }\n        }\n    }\n\n    private async measureImageDim(content: Uint8Array, name: string): Promise<string> {\n        if (name.endsWith('pdf')) {\n            const tempPDFURL = URL.createObjectURL(new Blob([content], { type: 'application/octet-stream' }));\n            try {\n                const pdfDoc = await getDocument(tempPDFURL).promise;\n                const page = await pdfDoc.getPage(1);\n                const viewport = page.getViewport({ scale: 1 });\n                const tmpWidth = viewport.width;\n                const tmpHeight = viewport.height;\n                pdfDoc.destroy();\n                return `swiftlatex\\n${tmpWidth}\\n${tmpHeight}\\n`;\n            } catch {\n                console.error(`Unable to measure the pdf document ${name}, return a dummy dimension `);\n                return 'swiftlatex\\n300\\n400\\n';\n            } finally {\n                URL.revokeObjectURL(tempPDFURL);\n            }\n        } else {\n            return new Promise((resolve, reject) => {\n                const tempImageURL = URL.createObjectURL(new Blob([content], { type: 'application/octet-stream' }));\n                const tmpImgElement = new Image();\n                tmpImgElement.onload = (_ => {\n                    URL.revokeObjectURL(tempImageURL);\n                    resolve(`swiftlatex\\n${tmpImgElement.width}\\n${tmpImgElement.height}\\n`);\n                });\n                tmpImgElement.onerror = (_ => {\n                    console.error(`Unable to measure the image document ${name}, return a dummy dimension `);\n                    URL.revokeObjectURL(tempImageURL);\n                    resolve('swiftlatex\\n300\\n400\\n');\n                });\n                tmpImgElement.src = tempImageURL;\n            });\n        }\n    }\n\n    protected async fullBuild(): Promise<void> {\n        /* Force a sync */\n        this.hasFileSyncedToEngine = false;\n\n        this.messageService.info('Building...', { timeout: 3000 });\n\n        /* Reach the fix point in 3 times */\n        const try_time = 3;\n        for (let j = 0; j < try_time; j++) {\n            const res = await this.quickBuild(true);\n            if (!res) {\n                break;\n            }\n        }\n    }\n\n    protected async cleanProject(): Promise<void> {\n        this.messageService.info('Cleaning build cache...', { timeout: 3000 });\n        if (!this.latexEngine.isReady()) {\n            return;\n        }\n        this.hasFileSyncedToEngine = false;\n        this.latexEngine.flushCache();\n    }\n\n    protected async exportPDF(): Promise<void> {\n        if (!this.cachedXDV) {\n            return;\n        }\n        this.messageService.info('Exporting PDF...', { timeout: 3000 });\n        await this.xdvExporter.loadExporter();\n        await this._syncFileToExporter('/');\n        this.xdvExporter.writeMainEntryFile(this.cachedXDV);\n        const res = await this.xdvExporter.exportPDF();\n        this.xdvExporter.closeWorker();\n        this.output_channel.clear();\n        this.output_channel.append(res.log);\n        if (res.status === 1 || res.status === 0) {\n            const tempPDFURL = URL.createObjectURL(new Blob([res.pdf!], { type: 'application/octet-stream' }));\n            let anchor: HTMLAnchorElement | undefined = document.createElement('a');\n            try {\n                anchor.href = tempPDFURL;\n                anchor.style.display = 'none';\n                anchor.download = 'export.pdf';\n                document.body.appendChild(anchor);\n                anchor.click();\n            } finally {\n                // make sure anchor is removed from parent\n                if (anchor && anchor.parentNode) {\n                    anchor.parentNode.removeChild(anchor);\n                }\n                URL.revokeObjectURL(tempPDFURL);\n                anchor = undefined;\n            }\n        } else {\n            /* Failed */\n            this.messageService.error('Unexpected error detected when generating PDF.', { timeout: 3000 });\n        }\n\n    }\n\n    protected async restartEngine(): Promise<void> {\n        this.messageService.info('Restarting Engine...', { timeout: 3000 });\n        this.latexEngine.closeWorker();\n        this.xdvExporter.closeWorker();\n        this.hasFileSyncedToEngine = false;\n        await this.latexEngine.loadEngine();\n    }\n\n    protected fireDidChangeContents(param: MonacoDidChangeTextDocumentParams): void {\n        if (this.shouldIgnore(param.textDocument)) {\n            return;\n        }\n        const save_uri = param.textDocument.uri.substr(7);\n        if (this.latexEngine.isReady()) {\n            this.latexEngine.writeMemFSFile(param.textDocument.getText(), save_uri);\n            /* Please fire up a new compilation */\n        }\n\n        /* To call previewer */\n        const changeEvent = param.contentChanges;\n        if (changeEvent.length === 1) {\n            const affected: number = (<any>changeEvent[0]).rangeLength;\n            if (affected === 1) {\n                /* Delete */\n                const internal_model = param.textDocument.textEditorModel;\n                const internal_stack: any = (<any>internal_model)._commandManager;\n                const last_operation_reverse: any = internal_stack.currentOpenStackElement;\n                if (last_operation_reverse && last_operation_reverse.editOperations && last_operation_reverse.editOperations.length === 1) {\n                    const rev_ops: any = last_operation_reverse.editOperations[0];\n                    if (rev_ops && rev_ops.operations && rev_ops.operations.length === 1) {\n                        const rev_op: any = rev_ops.operations[0];\n                        if (rev_op && rev_op.text) {\n                            this.preview_widget.handleCharacterDeleted(rev_op.text);\n                        }\n\n                    }\n                }\n            } else if (affected === 0) {\n                /* Insert */\n                if (changeEvent[0].text.length === 1) {\n                    this.preview_widget.handleCharacterInserted(changeEvent[0].text);\n                }\n            }\n            // console.dir(changeEvent[0]);\n        }\n\n        if (save_uri.endsWith('.tex')) {\n            this.tryBuild();\n        }\n    }\n\n    private tryBuild(): void {\n        if (this.retryHandle > 0) {\n            clearTimeout(this.retryHandle);\n            this.retryHandle = -1;\n        }\n\n        if (this.latexEngine.isReady() && Date.now() - this.lastCompileTime > RETRY_INTERVAL) {\n            this.lastCompileTime = Date.now();\n            this.quickBuild().catch(e => {\n\n            });\n        } else {\n            this.retryHandle = window.setTimeout(() => {\n                this.tryBuild();\n            }, RETRY_INTERVAL);\n        }\n    }\n\n    protected fireDidOpenDocument(model: MonacoEditorModel): void {\n        if (this.shouldIgnore(model)) {\n            return;\n        }\n        /* Kick off YJS */\n        if (this.opened_yjs_handles.has(model.uri)) {\n            return;\n        }\n        new MonacoYJSBinding(model);\n    }\n\n    protected fireDidCloseDocument(model: MonacoEditorModel): void {\n        if (this.shouldIgnore(model)) {\n            return;\n        }\n        if (this.opened_yjs_handles.has(model.uri)) {\n            this.opened_yjs_handles.delete(model.uri);\n        }\n    }\n\n    private shouldIgnore(model: MonacoEditorModel): boolean {\n        if (!model || !model.valid) {\n            return true;\n        }\n        if (!model.uri.startsWith('file:///')) {\n            return true;\n        }\n        if (model.uri.startsWith('file:///.theia') ||\n            model.uri.startsWith('file:///.vscode') ||\n            model.uri.startsWith('file:///.swiftlatex')) {\n            return true;\n        }\n        return false;\n    }\n\n    private async resolveMainFile(): Promise<string[]> {\n        /* has resolved before */\n        const saved_mainfile = window.localStorage.getItem(window.location.pathname + 'main_config');\n\n        if (saved_mainfile) {\n            return [saved_mainfile];\n        }\n\n        const objs = await this.s3filesystem.readdir('/');\n        /* Try previous saved mainfile */\n\n        const possibleCandicates: string[] = [];\n        /* See whether there is only one .tex file */\n        for (let k = 0; k < objs.length; k++) {\n            if (!objs[k].isDir && objs[k].uri.endsWith('.tex')) {\n                possibleCandicates.push(objs[k].uri.substr(1));\n            }\n        }\n\n        /* cache it so we dont have to do it again */\n        if (possibleCandicates.length === 1) {\n            window.localStorage.setItem(window.location.pathname + 'main_config', possibleCandicates[0]);\n        }\n\n        return possibleCandicates;\n    }\n\n    private setMainFile(uri: URI): void {\n        if (!uri) {\n            return;\n        }\n\n        const uri_str = uri.toString().substr(8);\n        window.localStorage.setItem(window.location.pathname + 'main_config', uri_str);\n        this.messageService.info(`Set ${uri_str} as the main entry.`, { timeout: 3000 });\n    }\n\n    private canSetAsMainFile(uri: URI): boolean {\n        if (!uri) {\n            return false;\n        }\n\n        const uri_string = uri.toString();\n\n        if (!uri_string.endsWith('.tex')) {\n            return false;\n        }\n\n        if (!uri_string.startsWith('file:///')) {\n            return false;\n        }\n\n        return (uri_string.match(/\\//g) || []).length === 3;\n    }\n\n    private async _syncFileToExporter(url: string): Promise<void> {\n        const objs = await this.s3filesystem.readdir(url);\n        for (let j = 0; j < objs.length; j++) {\n            const obj = objs[j];\n            if (obj.isDir) {\n                if (obj.uri.includes('.swiftlatex') || obj.uri.includes('.theia')) {\n                    continue;\n                }\n                this.xdvExporter.makeMemFSFolder(obj.uri);\n                await this._syncFileToExporter(obj.uri);\n            } else {\n                const content: Uint8Array = await this.s3filesystem.readFile(obj.uri);\n                this.xdvExporter.writeMemFSFile(content, obj.uri);\n                console.log('Writing file to exporter ' + obj.uri);\n            }\n        }\n    }\n\n    protected async listenOnDirChange(): Promise<void> {\n        const fileUri = new URI('file:///');\n        const watcher = await this.fileSystemWatcher.watchFileChanges(fileUri);\n        this.toDispose.push(watcher);\n        const onFileChange = (events: FileChangeEvent) => {\n            for (let k = 0; k < events.length; k++) {\n                /* Todo Import a more clear symbol */\n                /* We mean delete or add file */\n                if (events[k].type === 1 || events[k].type === 2) {\n                    console.log('Need to resync file');\n                    this.hasFileSyncedToEngine = false;\n                    break;\n                }\n            }\n        };\n        this.toDispose.push(this.fileSystemWatcher.onFilesChanged(onFileChange));\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n}\n","/********************************************************************************\n * Copyright (C) 2019 Elliott Wen.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { LaTeXClientContribution } from './theia-latex-spellchecker';\nimport { LanguageClientContribution } from '@theia/languages/lib/browser';\nimport { ContainerModule } from 'inversify';\nimport { LaTeXCommandContribution, LaTeXMenuContribution } from './theia-latex-contribution';\nimport { CommandContribution, MenuContribution } from '@theia/core/lib/common';\nimport { LaTeXEngine } from './latex-engine';\nimport { XDVExporter } from './xdv-exporter';\nimport { LanguageGrammarDefinitionContribution } from '@theia/monaco/lib/browser/textmate/textmate-contribution';\nimport { TeXContribution } from './latex-grammar';\nimport { BibTeXContribution } from './bibtex-grammar';\n\nexport default new ContainerModule(bind => {\n\t// add your contribution bindings here\n\tbind(LaTeXEngine).toSelf().inSingletonScope();\n\tbind(XDVExporter).toSelf().inSingletonScope();\n\tbind(LaTeXClientContribution).toSelf().inSingletonScope();\n\tbind(LanguageClientContribution).toDynamicValue(ctx => ctx.container.get(LaTeXClientContribution));\n\tbind(LaTeXCommandContribution).toSelf().inSingletonScope();\n\tbind(CommandContribution).toService(LaTeXCommandContribution);\n\tbind(LaTeXMenuContribution).toSelf().inSingletonScope();\n\tbind(MenuContribution).toService(LaTeXMenuContribution);\n\n\tbind(TeXContribution).toSelf().inSingletonScope();\n    bind(LanguageGrammarDefinitionContribution).toService(TeXContribution);\n    bind(BibTeXContribution).toSelf().inSingletonScope();\n    bind(LanguageGrammarDefinitionContribution).toService(BibTeXContribution);\n});\n","/********************************************************************************\n * Copyright (C) 2019 Elliott Wen.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable, inject } from 'inversify';\nimport { DocumentSelector, BaseLanguageClientContribution, Workspace, Languages, LanguageClientFactory } from '@theia/languages/lib/browser';\nimport { LATEX_LANGUAGE_ID, LATEX_LANGUAGE_NAME } from '../common';\n@injectable()\nexport class LaTeXClientContribution extends BaseLanguageClientContribution {\n\n    readonly id = LATEX_LANGUAGE_ID;\n    readonly name = LATEX_LANGUAGE_NAME;\n\n    constructor(\n        @inject(Workspace) protected readonly workspace: Workspace,\n        @inject(Languages) protected readonly languages: Languages,\n        @inject(LanguageClientFactory) protected readonly languageClientFactory: LanguageClientFactory\n    ) {\n        super(workspace, languages, languageClientFactory);\n    }\n\n    protected get globPatterns(): string[] {\n        return [\n            '**/*.tex',\n            '**/*.bib'\n        ];\n    }\n\n    protected get documentSelector(): DocumentSelector | undefined {\n        return [this.id, 'bibtex'];\n    }\n}\n","/********************************************************************************\n * Copyright (C) 2019 Elliott Wen.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { injectable } from 'inversify';\nexport enum ExporterStatus {\n\tInit = 1,\n\tReady,\n\tBusy,\n\tError,\n\tFinish\n}\n\nconst ENGINE_PATH = '/bin/dvipdfmx.js';\n\nexport class ConvertResult {\n\tpdf: Uint8Array | undefined = undefined;\n\tstatus: number = -254;\n\tlog: string = 'No log';\n}\n\n@injectable()\nexport class XDVExporter {\n\tprivate xdvWorker: Worker | undefined = undefined;\n\tpublic xdvWorkerStatus: ExporterStatus = ExporterStatus.Init;\n\tconstructor() {\n\t}\n\n\tpublic async loadExporter(): Promise<void> {\n\t\tif (this.xdvWorker !== undefined) {\n\t\t\tthrow new Error('Other instance is running, abort()');\n\t\t}\n\t\tthis.xdvWorkerStatus = ExporterStatus.Init;\n\t\tawait new Promise((resolve, reject) => {\n\t\t\tthis.xdvWorker = new Worker(ENGINE_PATH);\n\t\t\tthis.xdvWorker.onmessage = (ev: any) => {\n\t\t\t\tconst data: any = ev['data'];\n\t\t\t\tconst cmd: string = <string>(data['cmd']);\n\t\t\t\tif (cmd === 'postRun') {\n\t\t\t\t\tthis.xdvWorkerStatus = ExporterStatus.Ready;\n\t\t\t\t\tresolve();\n\t\t\t\t} else {\n\t\t\t\t\tthis.xdvWorkerStatus = ExporterStatus.Error;\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\n\t\tthis.xdvWorker!.onmessage = (ev: any) => {\n\t\t};\n\t}\n\n\tprivate checkExporterStatus(): void {\n\t\tif (this.xdvWorkerStatus !== ExporterStatus.Ready) {\n\t\t\tthrow Error('Engine is still spinning.');\n\t\t}\n\t}\n\n\tpublic async exportPDF(): Promise<ConvertResult> {\n\t\tthis.checkExporterStatus();\n\t\tthis.xdvWorkerStatus = ExporterStatus.Busy;\n\t\tconst start_compile_time = performance.now();\n\t\tconst res: ConvertResult = await new Promise((resolve, reject) => {\n\t\t\tthis.xdvWorker!.onmessage = (ev: any) => {\n\t\t\t\tconst data: any = ev['data'];\n\t\t\t\tconst cmd: string = <string>(data['cmd']);\n\t\t\t\tconst result: string = <string>data['result'];\n\t\t\t\tconst log: string = <string>data['log'];\n\t\t\t\tconst status: number = <number>data['status'];\n\t\t\t\tconst pdf: Uint8Array = <Uint8Array>data['pdf'];\n\t\t\t\tif (cmd === 'export') {\n\t\t\t\t\tif (result === 'failed') {\n\t\t\t\t\t\tconsole.error('Exporter crushed terribly. Log: ' + log);\n\t\t\t\t\t\tthis.xdvWorkerStatus = ExporterStatus.Error;\n\t\t\t\t\t\treject(log);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('Exporter compilation finish ' + (performance.now() - start_compile_time));\n\t\t\t\t\t\tconst nice_report = new ConvertResult();\n\t\t\t\t\t\tnice_report.status = status;\n\t\t\t\t\t\tnice_report.log = log;\n\t\t\t\t\t\tnice_report.pdf = pdf;\n\t\t\t\t\t\tthis.xdvWorkerStatus = ExporterStatus.Finish;\n\t\t\t\t\t\tresolve(nice_report);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.xdvWorker!.postMessage({ 'cmd': 'export' });\n\t\t});\n\n\t\tthis.xdvWorker!.onmessage = (ev: any) => {\n\t\t};\n\t\treturn res;\n\t}\n\n\tpublic writeMemFSFile(srccode: string | Uint8Array, filename: string): void {\n\t\tthis.checkExporterStatus();\n\t\tif (this.xdvWorker !== undefined) {\n\t\t\tthis.xdvWorker.postMessage({ 'cmd': 'writefile', 'url': filename, 'src': srccode });\n\t\t}\n\t}\n\n\tpublic writeMainEntryFile(srccode: string | Uint8Array): void {\n\t\tthis.writeMemFSFile(srccode, 'InP0t_SwIfTLoTEx_.xdv');\n\t}\n\n\tpublic makeMemFSFolder(folder: string): void {\n\t\tthis.checkExporterStatus();\n\t\tif (this.xdvWorker !== undefined) {\n\t\t\tif (folder === '' || folder === '/') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.xdvWorker.postMessage({ 'cmd': 'mkdir', 'url': folder });\n\t\t}\n\t}\n\n\tpublic closeWorker(): void {\n\t\tif (this.xdvWorker !== undefined) {\n\t\t\tthis.xdvWorker.postMessage({ 'cmd': 'grace' });\n\t\t\tthis.xdvWorker = undefined;\n\t\t}\n\t}\n}\n","/********************************************************************************\n * Copyright (C) 2019 Elliott Wen.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/* eslint-disable @typescript-eslint/no-explicit-any */\nexport class CharPosition {\n\tline: number;\n\n\tcolumn: number;\n\n\tgroup: number;\n\n\tcs: number;\n\n\tfid: number;\n\n\tconstructor() {\n\t\tthis.line = 0;\n\t\tthis.column = 0;\n\t\tthis.group = 0;\n\t\tthis.cs = 0;\n\t\tthis.fid = 0;\n\t}\n}\n\nclass Position {\n\th: number;\n\n\tv: number;\n\n\tw: number;\n\n\tx: number;\n\n\ty: number;\n\n\tz: number;\n\n\tconstructor(properties?: Position) {\n\t\tif (properties) {\n\t\t\tthis.h = properties.h;\n\t\t\tthis.v = properties.v;\n\t\t\tthis.w = properties.w;\n\t\t\tthis.x = properties.x;\n\t\t\tthis.y = properties.y;\n\t\t\tthis.z = properties.z;\n\t\t} else {\n\t\t\tthis.h = 0;\n\t\t\tthis.v = 0;\n\t\t\tthis.w = 0;\n\t\t\tthis.x = 0;\n\t\t\tthis.y = 0;\n\t\t\tthis.z = 0;\n\t\t}\n\t}\n}\n\nexport class DviFont {\n\tname: string;\n\n\tchecksum: number;\n\n\tscaleFactor: number;\n\n\tdesignSize: number;\n\n\tfaceindex: number;\n\n\theight: number;\n\n\tdepth: number;\n\n\trbga: number;\n\n\textend: number;\n\n\tslant: number;\n\n\tembolden: number;\n\n\tisnative: boolean;\n}\n\nexport class XDVMachine {\n\tbody: string = '';\n\n\tstyle: string = '';\n\n\tpointsPerDviUnit: number = 0;\n\n\tsvgDepth: number = 0;\n\n\tcolor: string = 'black';\n\n\tcolorStack: string[] = [];\n\n\tpaperwidth: number = 600;\n\n\tpaperheight: number = 800;\n\n\tcurrentpage: number = 1;\n\n\tfonts: Map<number, DviFont> = new Map<number, DviFont>();\n\n\tfont: DviFont; /* Do need to init */\n\n\tusedfonts: Map<string, number> = new Map<string, number>();\n\n\tstack: Position[] = [];\n\n\tposition: Position; /* Do need to init */\n\n\th_offset = 4736287;\n\n\tv_offset = 4736287;\n\n\tinTextMode = false;\n\n\ttotalPages = 0;\n\n\tlastSpacePos: CharPosition | undefined = undefined;\n\n\tfileList: string[] = [];\n\n\tconstructor() {\n\n\t}\n\n\tgetBody(): string {\n\t\treturn this.body;\n\t}\n\n\tgetStyle(): string {\n\t\treturn this.style;\n\t}\n\n\tpushColor(c: string): void {\n\t\tthis.endTextMode();\n\t\tthis.colorStack.push(this.color);\n\t\tthis.color = c;\n\t}\n\n\tpopColor(): void {\n\t\tthis.endTextMode();\n\t\tif (this.colorStack.length >= 1) {\n\t\t\tthis.color = this.colorStack.pop()!;\n\t\t} else {\n\t\t\tthrow Error('Color stack is empty');\n\t\t}\n\t}\n\n\tsetPapersize(width: number, height: number): void {\n\t\tthis.paperwidth = width;\n\t\tthis.paperheight = height;\n\t\tthis.style += `#page${this.currentpage} { position:relative; width:${this.paperwidth}px; height:${this.paperheight}px; border-width: thin; }\\n`;\n\t}\n\n\tputSVG(svg: string): void {\n\t\tthis.endTextMode();\n\t\tconst left = (this.position.h + this.h_offset) * this.pointsPerDviUnit;\n\t\tconst top = (this.position.v + this.v_offset) * this.pointsPerDviUnit;\n\n\t\tthis.svgDepth += (svg.match(/<svg>/g) || []).length;\n\t\tthis.svgDepth -= (svg.match(/<\\/svg>/g) || []).length;\n\n\t\tsvg = svg.replace('<svg>', '<svg width=\"10px\" height=\"10px\" viewBox=\"-5 -5 10 10\" style=\"overflow: visible; position: absolute;\">');\n\n\t\tsvg = svg.replace(/{\\?x}/g, left.toString());\n\t\tsvg = svg.replace(/{\\?y}/g, top.toString());\n\n\t\tthis.body += svg;\n\t}\n\n\tpush(): void {\n\t\tthis.endTextMode();\n\t\tthis.stack.push(new Position(this.position));\n\t}\n\n\tpop(): void {\n\t\tthis.endTextMode();\n\t\tif (this.stack.length >= 1) {\n\t\t\tthis.position = this.stack.pop()!;\n\t\t} else {\n\t\t\tthrow Error('Position stack is empty');\n\t\t}\n\t}\n\n\tbeginPage(page: number, h_offset: number, v_offset: number): void {\n\t\tthis.stack = [];\n\t\tthis.position = new Position();\n\t\tthis.currentpage = page + 1;\n\t\tthis.body += `<div id='page${this.currentpage}' class='page_decoration'>`;\n\t}\n\n\tendPage(): void {\n\t\tthis.endTextMode();\n\t\tthis.body += '</div>';\n\t}\n\n\tpost(_p: any): void {\n\t}\n\n\tpostPost(_p: any): void {\n\t}\n\n\tendTextMode(): void {\n\t\tif (this.inTextMode) {\n\t\t\tthis.body += '</div>';\n\t\t\tthis.inTextMode = false;\n\t\t}\n\t}\n\n\tmoveRight(distance: number): void {\n\t\tthis.position.h += distance;\n\t\tif (this.inTextMode) {\n\t\t\tlet l = 0;\n\t\t\tlet c = 0;\n\t\t\tlet f = 0;\n\t\t\tlet cs = 0;\n\t\t\tif (this.lastSpacePos) {\n\t\t\t\tl = this.lastSpacePos.line;\n\t\t\t\tc = this.lastSpacePos.column;\n\t\t\t\tf = this.lastSpacePos.fid;\n\t\t\t\tcs = this.lastSpacePos.cs;\n\t\t\t\tthis.lastSpacePos = undefined;\n\t\t\t}\n\t\t\tconst inpixel = Number(distance * this.pointsPerDviUnit).toFixed(2);\n\t\t\tthis.body += `<span l='${l}' c='${c}' f='${f}' cs='${cs}' class='pf-space' style='width: ${inpixel}px;'> </span>`;\n\t\t}\n\t}\n\n\tmoveDown(distance: number): void {\n\t\tthis.position.v += distance;\n\t}\n\n\tsetFont(fontnum: number): void {\n\t\tthis.endTextMode();\n\t\tif (this.fonts.has(fontnum)) {\n\t\t\tthis.font = this.fonts.get(fontnum)!;\n\t\t\tif (!(this.usedfonts.has(this.font.name))) {\n\t\t\t\tthis.usedfonts.set(this.font.name, 1);\n\t\t\t\tif (this.font.isnative) {\n\t\t\t\t\tif (this.font.name.endsWith('.ttf') || this.font.name.endsWith('.otf')) {\n\t\t\t\t\t\t// Local font\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Remote font\n\t\t\t\t\t\tthis.style += `@font-face { font-family:${this.font.name}; src:url(https://texlive.swiftlatex.com/${this.font.name}.otf); } \\n\\n`;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Texfont\n\t\t\t\t\tthis.style += `@font-face { font-family:${this.font.name}; src:url(https://texlive.swiftlatex.com/fonts/${this.font.name}.woff); }\\n`;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow Error(`Could not find font ${fontnum}.`);\n\t\t}\n\t}\n\n\tpreamble(numerator: number, denominator: number, magnification: number, comment: string): void {\n\t\tconst dviUnit = magnification * numerator / 1000.0 / denominator;\n\n\t\tthis.pointsPerDviUnit = dviUnit * 72.27 / 100000.0 / 2.54;\n\t}\n\n\tputRule(rulea: number, ruleb: number, moved: boolean): void {\n\t\tthis.endTextMode();\n\t\tconst a = rulea * this.pointsPerDviUnit;\n\t\tconst b = ruleb * this.pointsPerDviUnit;\n\t\tconst left = (this.position.h + this.h_offset) * this.pointsPerDviUnit;\n\t\tconst bottom = (this.position.v + this.v_offset) * this.pointsPerDviUnit;\n\t\tconst top = bottom - a;\n\n\t\tthis.body += `<span style=\"background: ${this.color}; position: absolute; top: ${top}px; left: ${left}px; width:${b}px; height: ${a}px;\"></span>\\n`;\n\t\tif (moved) {\n\t\t\tthis.position.h += ruleb;\n\t\t}\n\t}\n\n\t_to_legal_unicode(c: number): number {\n\t\tif ((c <= 0x20) || (c >= 0x7F && c <= 0xA0) || (c === 0xAD)) {\n\t\t\treturn c + 0xE000;\n\t\t}\n\t\treturn c;\n\t}\n\n\tsetChar(c: number, text_height: number, text_width: number, pos: CharPosition): void {\n\t\tthis.endTextMode();\n\t\tc = this._to_legal_unicode(c);\n\t\tconst htmlText = String.fromCharCode(c);\n\t\t// console.log(htmlText + ' ' + text_width);\n\t\tconst cssleft = (this.position.h + this.h_offset) * this.pointsPerDviUnit;\n\t\tconst cssheight = text_height * this.pointsPerDviUnit;\n\t\tconst csstop = (this.position.v + this.v_offset) * this.pointsPerDviUnit;\n\t\t// console.log(this.font.scaleFactor);\n\t\tconst fontsize = this.font.designSize / 65536.0;\n\t\tif (this.svgDepth === 0) {\n\t\t\tthis.body += `<div style=\"line-height: 0; color: ${this.color}; \n            font-family: ${this.font.name}; font-size: ${fontsize}px; \n            position: absolute; top: ${Number(csstop - cssheight).toFixed(2)}px; vertical-align: baseline;\n            left: ${Number(cssleft).toFixed(2)}px;\">${htmlText}<span style=\"display: inline-block;\n             vertical-align: ${Number(cssheight).toFixed(2)}px; height: 0px; line-height: 0;\"></span></div>`;\n\t\t} else {\n\t\t\tconst bottom = (this.position.v + this.v_offset) * this.pointsPerDviUnit;\n\t\t\tthis.body += `<text alignment-baseline=\"baseline\"\n            y=\"${bottom}\" x=\"${cssleft}\" style=\"font-family: ${this.font.name};\"\n            font-size=\"${fontsize}\">${htmlText}</text>\\n`;\n\t\t}\n\t\tthis.position.h += text_width;\n\t}\n\n\tsetSpace(pos: CharPosition): void {\n\t\tif (pos.line !== 0) {\n\t\t\tthis.lastSpacePos = pos;\n\t\t}\n\t\t// console.log(pos.line + ' ' + pos.column);\n\t}\n\n\tsetNativeText(text: number[], textpos: CharPosition[], width: number): void {\n\t\tconst cssleft = (this.position.h + this.h_offset) * this.pointsPerDviUnit;\n\t\tconst csstop = (this.position.v + this.v_offset) * this.pointsPerDviUnit;\n\t\tconst fontsize = this.font.designSize * this.font.extend;\n\t\tconst textheight = fontsize; /* Todo, not sure whether it is correct */\n\t\tif (!this.inTextMode) {\n\t\t\tthis.inTextMode = true;\n\t\t\tthis.body += `<div class=\"pf-line\"\n            style=\"color: ${this.color}; font-family: ${this.font.name};\n            font-size: ${Number(fontsize).toFixed(2)}px;\n            top: ${Number(csstop - textheight).toFixed(2)}px;\n            left: ${Number(cssleft).toFixed(2)}px;\">`;\n\t\t}\n\n\t\tfor (let j = 0; j < text.length; j++) {\n\t\t\tconst pos = textpos[j];\n\t\t\tthis.body += `<span l='${pos.line}'\n            c='${pos.column}' f='${pos.fid}' cs='${pos.cs}'>${String.fromCharCode(text[j])}</span>`;\n\t\t}\n\n\t\tthis.position.h += width;\n\t}\n\n\tputImage(width: number, height: number, url: string): void {\n\t\tthis.endTextMode();\n\t\tconst cssleft = (this.position.h + this.h_offset) * this.pointsPerDviUnit;\n\n\t\tconst csstop = (this.position.v + this.v_offset) * this.pointsPerDviUnit;\n\t\tthis.body += `<div data-url=\"${url}\"\n        style=\"top: ${Number(csstop - height).toFixed(2)}px;\n        left: ${Number(cssleft).toFixed(2)}px;\n        position: absolute; height:${Number(height).toFixed(2)}px;\n        width:${Number(width).toFixed(2)}px;\n        background-color:grey;\"></div>`;\n\t}\n\n\tloadFont(properties: any, fontnumber: number, isnative: boolean): void {\n\t\tconst f = new DviFont();\n\t\tif (!isnative) {\n\t\t\tf.name = properties.name;\n\t\t\tf.checksum = properties.checksum;\n\t\t\tf.scaleFactor = properties.scaleFactor;\n\t\t\tf.designSize = properties.designSize;\n\t\t\tf.isnative = false;\n\t\t} else {\n\t\t\tf.name = properties.name;\n\t\t\tf.designSize = properties.fontsize;\n\t\t\tf.faceindex = properties.faceindex;\n\t\t\tf.height = properties.height;\n\t\t\tf.depth = properties.depth;\n\t\t\tf.rbga = properties.rgba;\n\t\t\tif (!f.rbga) {\n\t\t\t\tf.rbga = 0xffffffff;\n\t\t\t}\n\t\t\tf.extend = properties.extend;\n\t\t\tif (!f.extend) {\n\t\t\t\tf.extend = 1.0;\n\t\t\t}\n\t\t\tf.slant = properties.slant;\n\t\t\tif (!f.slant) {\n\t\t\t\tf.slant = 0;\n\t\t\t}\n\t\t\tf.embolden = properties.embolden;\n\t\t\tif (!f.embolden) {\n\t\t\t\tf.embolden = 0;\n\t\t\t}\n\t\t\tf.isnative = true;\n\t\t}\n\t\tthis.fonts.set(fontnumber, f);\n\t}\n}\n","/********************************************************************************\n * Copyright (C) 2019 Elliott Wen.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { XDVMachine, CharPosition } from './xdv-machine';\n\nconst FILE_VERSION = 71;\n\nenum Opcode {\n\tset_char = 0,\n\tset1 = 128,\n\tset2 = 129,\n\tset3 = 130,\n\tset4 = 131,\n\tset_rule = 132,\n\tput_char = 133,\n\tput2 = 134,\n\tput3 = 135,\n\tput4 = 136,\n\tput_rule = 137,\n\tnop = 138,\n\tbop = 139,\n\teop = 140,\n\tpush = 141,\n\tpop = 142,\n\tright = 143,\n\tright2 = 144,\n\tright3 = 145,\n\tright4 = 146,\n\tw = 147,\n\tw1 = 148,\n\tw2 = 149,\n\tw3 = 150,\n\tw4 = 151,\n\tx = 152,\n\tx1 = 153,\n\tx2 = 154,\n\tx3 = 155,\n\tx4 = 156,\n\tdown = 157,\n\tdown2 = 158,\n\tdown3 = 159,\n\tdown4 = 160,\n\ty = 161,\n\ty1 = 162,\n\ty2 = 163,\n\ty3 = 164,\n\ty4 = 165,\n\tz = 166,\n\tz1 = 167,\n\tz2 = 168,\n\tz3 = 169,\n\tz4 = 170,\n\tfnt = 171,\n\tfnt1 = 235,\n\tfnt2 = 236,\n\tfnt3 = 237\n\t, fnt4 = 238,\n\txxx = 239,\n\txxx2 = 240,\n\txxx3 = 241,\n\txxx4 = 242,\n\tfnt_def = 243,\n\tfnt_def2 = 244,\n\tfnt_def3 = 245,\n\tfnt_def4 = 246,\n\tpre = 247,\n\tpost = 248,\n\tpost_post = 249,\n\tdefine_native_font = 252,\n\tset_glyphs = 253,\n\tset_text_and_glyphs = 254\n}\n\nexport class DviCommand {\n\tlength: number;\n\n\tspecial: boolean;\n\n\tconstructor(properties: any) {\n\t\tthis.special = false;\n\t\tObject.assign(this, properties);\n\t}\n\n\texecute(machine: XDVMachine): void {\n\n\t}\n\n\ttoString(): string {\n\t\treturn 'DviCommand { }';\n\t}\n}\n\nexport class SetChar extends DviCommand {\n\topcode: Opcode.set_char;\n\n\tc: number;\n\n\ttext_height: number;\n\n\ttext_width: number;\n\n\tchar_positon: CharPosition;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.set_char;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.setChar(this.c, this.text_height, this.text_width, this.char_positon);\n\t}\n\n\ttoString(): string {\n\t\treturn `SetChar { c: '${String.fromCharCode(this.c)}' }`;\n\t}\n}\n\nexport class SetSpace extends DviCommand {\n\topcode: Opcode.set2;\n\n\tchar_positon: CharPosition;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.set2;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.setSpace(this.char_positon);\n\t}\n\n\ttoString(): string {\n\t\treturn 'SetSpace { _ }';\n\t}\n}\n\nexport class PutRule extends DviCommand {\n\topcode: Opcode.put_rule;\n\n\ta: number;\n\n\tb: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.put_rule;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.putRule(this.a, this.b, false);\n\t}\n\n\ttoString(): string {\n\t\treturn `PutRule { a: ${this.a}, b: ${this.b} }`;\n\t}\n}\n\nexport class SetRule extends DviCommand {\n\topcode: Opcode.set_rule;\n\n\ta: number;\n\n\tb: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.set_rule;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.putRule(this.a, this.b, true);\n\t}\n\n\ttoString(): string {\n\t\treturn `SetRule { a: ${this.a}, b: ${this.b} }`;\n\t}\n}\n\n// 138  nop     no operation\n\nclass Nop extends DviCommand {\n\topcode: Opcode.nop;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.nop;\n\t}\n\n\ttoString(): string {\n\t\treturn 'Nop { }';\n\t}\n}\n\n// 139  bop c_0[4]..c_9[4], p[4]    beginning of page\n\nclass Bop extends DviCommand {\n\topcode: Opcode.bop;\n\n\tc_0: number;\n\n\th_offset: number;\n\n\tv_offset: number;\n\n\tp: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.bop;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.beginPage(this.c_0, this.h_offset, this.v_offset);\n\t}\n\n\ttoString(): string {\n\t\treturn 'Bop { ... }';\n\t}\n}\n\n// 140  eop     ending of page\n\nclass Eop extends DviCommand {\n\topcode: Opcode.eop;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.eop;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tif (machine.stack.length) { throw new Error('Stack should be empty at the end of a page.'); }\n\n\t\tmachine.endPage();\n\t}\n\n\ttoString(): string {\n\t\treturn 'Eop { }';\n\t}\n}\n\n// 141  push        save the current positions\n\nclass Push extends DviCommand {\n\topcode: Opcode.push;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.push;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.push();\n\t}\n\n\ttoString(): string {\n\t\treturn 'Push { }';\n\t}\n}\n\n// 142  pop     restore previous positions\n\nclass Pop extends DviCommand {\n\topcode: Opcode.pop;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.pop;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.pop();\n\t}\n\n\ttoString(): string {\n\t\treturn 'Pop { }';\n\t}\n}\n\nclass MoveRight extends DviCommand {\n\topcode: Opcode.right;\n\n\tb: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.right;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.moveRight(this.b);\n\t}\n\n\ttoString(): string {\n\t\treturn `MoveRight { b: ${this.b} }`;\n\t}\n}\n\n// 147  w0      move right by w\n// 148  w1  b[1]    move right and set w\n// 149  w2  b[2]\n// 150  w3  b[3]\n// 151  w4  b[4]\n\nclass MoveW extends DviCommand {\n\topcode: Opcode.w;\n\n\tb: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.w;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tif (this.length > 1) {\n\t\t\tmachine.position.w = this.b;\n\t\t}\n\t\tmachine.moveRight(machine.position.w);\n\t}\n\n\ttoString(): string {\n\t\tif (this.length > 1) { return `MoveW { b: ${this.b} }`; }\n\t\treturn 'MoveW0 { }';\n\t}\n}\n\n// 152  x0      move right by x\n// 153  x1  b[1]    move right and set x\n// 154  x2  b[2]\n// 155  x3  b[3]\n// 156  x4  b[4]\n\nclass MoveX extends DviCommand {\n\topcode: Opcode.x;\n\n\tb: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.x;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tif (this.length > 1) {\n\t\t\tmachine.position.x = this.b;\n\t\t}\n\t\tmachine.moveRight(machine.position.x);\n\t}\n\n\ttoString(): string {\n\t\tif (this.length > 1) { return `MoveX { b: ${this.b} }`; }\n\t\treturn 'MoveX0 { }';\n\t}\n}\n\n// 157  down1   a[1]    move down\n// 158  down2   a[2]\n// 159  down3   a[3]\n// 160  down4   a[4]\n\nclass MoveDown extends DviCommand {\n\topcode: Opcode.down;\n\n\ta: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.down;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.moveDown(this.a);\n\t}\n\n\ttoString(): string {\n\t\treturn `MoveDown { a: ${this.a} }`;\n\t}\n}\n\n// 161  y0      move down by y\n// 162  y1  a[1]    move down and set y\n// 163  y2  a[2]\n// 164  y3  a[3]\n// 165  y4  a[4]\n\nclass MoveY extends DviCommand {\n\topcode: Opcode.y;\n\n\ta: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.y;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tif (this.length > 1) {\n\t\t\tmachine.position.y = this.a;\n\t\t}\n\t\tmachine.moveDown(machine.position.y);\n\t}\n\n\ttoString(): string {\n\t\tif (this.length > 1) { return `MoveY { a: ${this.a} }`; }\n\t\treturn 'MoveY0 { }';\n\t}\n}\n\n// 166  z0      move down by z\n// 167  z1  a[1]    move down and set z\n// 168  z2  a[2]\n// 169  z3  a[3]\n// 170  z4  a[4]\n\nclass MoveZ extends DviCommand {\n\topcode: Opcode.z;\n\n\ta: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.z;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tif (this.length > 1) {\n\t\t\tmachine.position.z = this.a;\n\t\t}\n\t\tmachine.moveDown(machine.position.z);\n\t}\n\n\ttoString(): string {\n\t\tif (this.length > 1) { return `MoveZ { a: ${this.a} }`; }\n\t\treturn 'MoveZ0 { }';\n\t}\n}\n\n// 171...234    fnt_num_i       set current font to i\n// 235  fnt1    k[1]    set current font\n// 236  fnt2    k[2]\n// 237  fnt3    k[3]\n// 238  fnt4    k[4]\n\nclass SetFont extends DviCommand {\n\topcode: Opcode.fnt;\n\n\tk: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.fnt;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\t// console.log(\"Setting mainfont to \" + this.k);\n\n\t\tmachine.setFont(this.k);\n\t}\n\n\ttoString(): string {\n\t\treturn `SetFont { k: ${this.k} }`;\n\t}\n}\n\n// 239  xxx1    k[1], x[k]  extension to DVI primitives\n// 240  xxx2    k[2], x[k]\n// 241  xxx3    k[3], x[k]\n// 242  xxx4    k[4], x[k]\n\nfunction _intToHex(n: number): string {\n\treturn (`00${Math.round(n).toString(16)}`).substr(-2);\n}\n\nfunction _texColor(name: string): string {\n\tif (name === 'gray 0') { return 'black'; }\n\tif (name === 'gray 1') { return 'white'; }\n\tif (name.startsWith('rgb ')) {\n\t\tconst out = name.split(' ').slice(1).map(x => _intToHex(parseFloat(x) * 255)).join('');\n\t\treturn `#${out}`;\n\t} else if (name.startsWith('gray ')) {\n\t\tconst x = name.split(' ')[1];\n\t\treturn _texColor(`rgb ${x} ${x} ${x}`);\n\t} else if (name.startsWith('cmyk ')) {\n\t\tconst channels = name.split(' ');\n\t\tif (channels.length === 5) {\n\t\t\tconst channel_c = parseFloat(channels[1]);\n\t\t\tconst channel_m = parseFloat(channels[2]);\n\t\t\tconst channel_y = parseFloat(channels[3]);\n\t\t\tconst channel_k = parseFloat(channels[4]);\n\t\t\tconst new_r = (1 - channel_c) * (1 - channel_k);\n\t\t\tconst new_g = (1 - channel_m) * (1 - channel_k);\n\t\t\tconst new_b = (1 - channel_y) * (1 - channel_k);\n\t\t\treturn _texColor(`rgb ${new_r} ${new_g} ${new_b}`);\n\t\t}\n\t}\n\treturn 'black';\n}\n\nclass Special extends DviCommand {\n\topcode: Opcode.xxx;\n\n\tx: string;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.xxx;\n\t\tthis.special = true;\n\t}\n\n\ttoString(): string {\n\t\treturn `Special { x: '${this.x}' }`;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tif (this.x.startsWith('dvisvgm:raw ')) {\n\t\t\tconst svg = this.x.replace(/^dvisvgm:raw /, '');\n\t\t\tmachine.putSVG(svg);\n\t\t} else if (this.x.startsWith('pdf:pagesize')) {\n\t\t\tconst papersize = this.x.replace(/^pdf:pagesize /, '');\n\t\t\tconst regex = /width ([0-9\\.]+)pt height ([0-9\\.]+)pt/gm;\n\t\t\tconst m = regex.exec(papersize);\n\t\t\tif (!m || m.length !== 3) {\n\t\t\t\t/* Fallback */\n\t\t\t\tmachine.setPapersize(595, 842);\n\t\t\t} else {\n\t\t\t\tconst paperWidth = Number(m[1]);\n\t\t\t\tconst paperHeight = Number(m[2]);\n\t\t\t\tmachine.setPapersize(paperWidth, paperHeight);\n\t\t\t}\n\t\t} else if (this.x.startsWith('color push ')) {\n\t\t\tconst color = _texColor(this.x.replace(/^color push /, ''));\n\t\t\tmachine.pushColor(color);\n\t\t} else if (this.x.startsWith('color pop')) {\n\t\t\tmachine.popColor();\n\t\t} else if (this.x.startsWith('pdf:image bbox 0 0 ')) {\n\t\t\tconst image = this.x.replace(/pdf:image bbox 0 0 /, '').split(' ');\n\t\t\tconst imageWidth = Number(image[0]);\n\t\t\tconst imageHeight = Number(image[1]);\n\t\t\tconst url = image[6].substr(1).slice(0, -1);\n\t\t\tmachine.putImage(imageWidth, imageHeight, url);\n\t\t} else {\n\t\t\tconsole.error('unhandled ' + this.x);\n\t\t}\n\t}\n}\n\nclass SetTextGlyph extends DviCommand {\n\topcode: Opcode.set_text_and_glyphs;\n\ttext: number[];\n\ttextpos: CharPosition[];\n\ttextcount: number;\n\twidth: number;\n\tglyphcount: number;\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.set_text_and_glyphs;\n\t}\n\texecute(machine: XDVMachine): void {\n\t\tmachine.setNativeText(this.text, this.textpos, this.width);\n\t}\n\ttoString(): string {\n\t\treturn `SetGlyph { count: ${this.textcount} }`;\n\t}\n}\n\nclass FontDefinition extends DviCommand {\n\topcode: Opcode.fnt_def;\n\n\tk: number; // font id\n\n\tc: number; // checksum\n\n\ts: number; // fixed-point scale factor (applied to char widths of font)\n\n\td: number; // design-size factors with the magnification (`s/1000`)\n\n\ta: number; // length of directory path of font (`./` if a = 0)\n\n\tl: number; // length of font name\n\n\tn: string; // font name (first `a` bytes is dir, remaining `l` = name)\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.fnt_def;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\t// console.log(\"Defining Local Font name: \" + this.n + \" index: \" + this.k);\n\t\tmachine.loadFont({\n\t\t\tname: this.n,\n\t\t\tchecksum: this.c,\n\t\t\tscaleFactor: this.s,\n\t\t\tdesignSize: this.d,\n\t\t}, this.k, false);\n\t}\n\n\ttoString(): string {\n\t\treturn `FontDefinition { k: ${this.k}, n: '${this.n}', ... }`;\n\t}\n}\n\n// 247  pre i[1], num[4], den[4], mag[4],  k[1], x[k]   preamble\n\nclass Preamble extends DviCommand {\n\topcode: Opcode.pre;\n\n\ti: number;\n\n\tnum: number;\n\n\tden: number;\n\n\tmag: number;\n\n\tx: string;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.pre;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tif (this.num <= 0) { throw new Error('Invalid numerator (must be > 0)'); }\n\n\t\tif (this.den <= 0) { throw new Error('Invalid denominator (must be > 0)'); }\n\n\t\tif (this.i !== FILE_VERSION) {\n\t\t\tthrow new Error('DVI format must be 71, which is SwiftLaTeX format ');\n\t\t}\n\n\t\tmachine.preamble(this.num, this.den, this.mag, this.x);\n\t}\n\n\ttoString(): string {\n\t\treturn `Preamble { i: ${this.i}, num: ${this.num}, den: ${this.den}, mag: ${this.mag}, x: '${this.x}' }`;\n\t}\n}\n\n// 248  post    p[4], num[4], den[4], mag[4], l[4], u[4], s[2], t[2]\n// < font definitions > postamble beginning\n\nclass Post extends DviCommand {\n\topcode: Opcode.post;\n\n\tp: number;\n\n\tnum: number;\n\n\tden: number;\n\n\tmag: number;\n\n\tl: number;\n\n\tu: number;\n\n\ts: number;\n\n\tt: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.post;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.post(this);\n\t}\n\n\ttoString(): string {\n\t\treturn `Post { p: ${this.p}, num: ${this.num}, den: ${this.den}, mag: ${this.mag}, ... }`;\n\t}\n}\n\n// 249  post_post   q[4], i[1]; 223's   postamble ending\n\nclass PostPost extends DviCommand {\n\topcode: Opcode.post_post;\n\n\tq: number;\n\n\ti: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.post_post;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\tmachine.postPost(this);\n\t}\n\n\ttoString(): string {\n\t\treturn `PostPost { q: ${this.q}, i: ${this.i} }`;\n\t}\n}\n\n// 252\n\nclass NativeFontDefinition extends DviCommand {\n\topcode: Opcode.define_native_font;\n\n\tfontnumber: number;\n\n\tfontsize: number;\n\n\tflag: number;\n\n\tfilenamelen: number;\n\n\tfilename: string;\n\n\tfaceindex: number;\n\n\theight: number;\n\n\tdepth: number;\n\n\trbga: number;\n\n\textend: number;\n\n\tslant: number;\n\n\tembolden: number;\n\n\tconstructor(properties: any) {\n\t\tsuper(properties);\n\t\tthis.opcode = Opcode.define_native_font;\n\t}\n\n\texecute(machine: XDVMachine): void {\n\t\t// console.log(\"Defining Native Font name: \" + this.filename + \" index: \" + this.fontnumber);\n\t\tmachine.loadFont({\n\t\t\tname: this.filename,\n\t\t\tfontsize: this.fontsize,\n\t\t\tfaceindex: this.faceindex,\n\t\t\theight: this.height,\n\t\t\tdepth: this.depth,\n\t\t\trbga: this.rbga,\n\t\t\textend: this.extend,\n\t\t\tslant: this.slant,\n\t\t\tembolden: this.embolden,\n\t\t}, this.fontnumber, true);\n\t}\n\n\ttoString(): string {\n\t\treturn `NativeFontDefinition { filename: ${this.filename}, fontnumber: ${this.fontnumber}, length: ${this.length}, rbga: ${this.rbga}}`;\n\t}\n}\n\ntype Command =\n\tSetChar | SetRule | PutRule | Nop | Bop | Eop | Push | Pop |\n\tMoveRight | MoveW | MoveX | MoveDown | MoveY | MoveZ | SetFont | Special |\n\tFontDefinition | Preamble | Post | PostPost | NativeFontDefinition | SetTextGlyph | SetSpace;\n\nfunction parseCommand(opcode: Opcode, buffer: Buffer): Command {\n\n\tconst undefined_codes: number[] = [250, 251, 255];\n\n\tif (<number>opcode in undefined_codes) {\n\t\tthrow new Error(`Undefined opcode ${opcode}`);\n\t}\n\n\tconst unsupported_codes: Opcode[] = [Opcode.set3, Opcode.set4, Opcode.put_char, Opcode.put2, Opcode.put3, Opcode.put4,\n\tOpcode.set_glyphs];\n\n\tif (opcode in undefined_codes) {\n\t\tthrow new Error('SwiftLaTeX does not support opcode ' + opcode);\n\t}\n\n\tif ((opcode >= Opcode.set_char) && (opcode < Opcode.set1)) {\n\t\tthrow new Error('SwiftLaTeX does not generate simple setchar');\n\t}\n\n\tif (opcode in unsupported_codes) {\n\t\tthrow new Error('SwiftLaTeX does not support code:' + opcode);\n\t}\n\n\tif ((opcode >= Opcode.fnt) && (opcode < Opcode.fnt1)) { return new SetFont({ k: opcode - 171, length: 1 }); }\n\n\tswitch (opcode) {\n\t\tcase Opcode.set1:\n\t\t\tif (buffer.length < 17) { throw new Error(`not enough bytes to process opcode ${opcode}`); }\n\t\t\tconst c = buffer.readUInt8(0);\n\t\t\tconst char_p = new CharPosition();\n\t\t\tchar_p.line = buffer.readUInt16BE(1);\n\t\t\tchar_p.column = buffer.readUInt16BE(3);\n\t\t\tchar_p.cs = buffer.readUInt16BE(5);\n\t\t\tchar_p.group = buffer.readUInt8(7);\n\t\t\tchar_p.fid = buffer.readUInt8(8);\n\t\t\tconst text_height = buffer.readUInt32BE(9);\n\t\t\tconst text_width = buffer.readUInt32BE(13);\n\t\t\treturn new SetChar({\n\t\t\t\tc: c,\n\t\t\t\ttext_height: text_height,\n\t\t\t\ttext_width: text_width,\n\t\t\t\tchar_positon: char_p,\n\t\t\t\tlength: 17 + 1\n\t\t\t});\n\n\t\tcase Opcode.set2:\n\t\t\tif (buffer.length < 10) { throw new Error(`not enough bytes to process opcode ${opcode}`); }\n\t\t\tconst char_sp = new CharPosition();\n\t\t\tchar_sp.line = buffer.readUInt16BE(2);\n\t\t\tchar_sp.column = buffer.readUInt16BE(4);\n\t\t\tchar_sp.cs = buffer.readUInt16BE(6);\n\t\t\tchar_sp.group = buffer.readUInt8(8);\n\t\t\tchar_sp.fid = buffer.readUInt8(9);\n\t\t\treturn new SetSpace({\n\t\t\t\tchar_positon: char_sp,\n\t\t\t\tlength: 10 + 1\n\t\t\t});\n\n\t\tcase Opcode.set_rule:\n\t\t\tif (buffer.length < 8) { throw new Error(`not enough bytes to process opcode ${opcode}`); }\n\t\t\treturn new SetRule({\n\t\t\t\ta: buffer.readInt32BE(0),\n\t\t\t\tb: buffer.readInt32BE(4),\n\t\t\t\tlength: 9,\n\t\t\t});\n\n\t\tcase Opcode.put_rule:\n\t\t\tif (buffer.length < 8) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new PutRule({\n\t\t\t\ta: buffer.readInt32BE(0),\n\t\t\t\tb: buffer.readInt32BE(4),\n\t\t\t\tlength: 9,\n\t\t\t});\n\n\t\tcase Opcode.nop:\n\t\t\treturn new Nop({ length: 1 });\n\n\t\tcase Opcode.bop:\n\t\t\tif (buffer.length < 44) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new Bop({\n\t\t\t\tc_0: buffer.readUInt32BE(0),\n\t\t\t\th_offset: buffer.readUInt32BE(4),\n\t\t\t\tv_offset: buffer.readUInt32BE(8),\n\t\t\t\tp: buffer.readUInt32BE(40),\n\t\t\t\tlength: 45,\n\t\t\t});\n\n\t\tcase Opcode.eop:\n\t\t\treturn new Eop({ length: 1 });\n\n\t\tcase Opcode.push:\n\t\t\treturn new Push({ length: 1 });\n\n\t\tcase Opcode.pop:\n\t\t\treturn new Pop({ length: 1 });\n\n\t\tcase Opcode.right:\n\t\tcase Opcode.right2:\n\t\tcase Opcode.right3:\n\t\tcase Opcode.right4:\n\t\t\tif (buffer.length < opcode - Opcode.right + 1) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new MoveRight({\n\t\t\t\tb: buffer.readIntBE(0, opcode - Opcode.right + 1),\n\t\t\t\tlength: opcode - Opcode.right + 1 + 1,\n\t\t\t});\n\n\t\tcase Opcode.w:\n\t\t\treturn new MoveW({ b: 0, length: 1 });\n\n\t\tcase Opcode.w1:\n\t\tcase Opcode.w2:\n\t\tcase Opcode.w3:\n\t\tcase Opcode.w4:\n\t\t\tif (buffer.length < opcode - Opcode.w) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new MoveW({\n\t\t\t\tb: buffer.readIntBE(0, opcode - Opcode.w),\n\t\t\t\tlength: opcode - Opcode.w + 1,\n\t\t\t});\n\n\t\tcase Opcode.x:\n\t\t\treturn new MoveX({ b: 0, length: 1 });\n\n\t\tcase Opcode.x1:\n\t\tcase Opcode.x2:\n\t\tcase Opcode.x3:\n\t\tcase Opcode.x4:\n\t\t\tif (buffer.length < opcode - Opcode.x) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new MoveX({\n\t\t\t\tb: buffer.readIntBE(0, opcode - Opcode.x),\n\t\t\t\tlength: opcode - Opcode.x + 1,\n\t\t\t});\n\n\t\tcase Opcode.down:\n\t\tcase Opcode.down2:\n\t\tcase Opcode.down3:\n\t\tcase Opcode.down4:\n\t\t\tif (buffer.length < opcode - Opcode.down + 1) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new MoveDown({\n\t\t\t\ta: buffer.readIntBE(0, opcode - Opcode.down + 1),\n\t\t\t\tlength: opcode - Opcode.down + 1 + 1,\n\t\t\t});\n\n\t\tcase Opcode.y:\n\t\t\treturn new MoveY({ a: 0, length: 1 });\n\n\t\tcase Opcode.y1:\n\t\tcase Opcode.y2:\n\t\tcase Opcode.y3:\n\t\tcase Opcode.y4:\n\t\t\tif (buffer.length < opcode - Opcode.y) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new MoveY({\n\t\t\t\ta: buffer.readIntBE(0, opcode - Opcode.y),\n\t\t\t\tlength: opcode - Opcode.y + 1,\n\t\t\t});\n\n\t\tcase Opcode.z:\n\t\t\treturn new MoveZ({ a: 0, length: 1 });\n\n\t\tcase Opcode.z1:\n\t\tcase Opcode.z2:\n\t\tcase Opcode.z3:\n\t\tcase Opcode.z4:\n\t\t\tif (buffer.length < opcode - Opcode.z) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new MoveZ({\n\t\t\t\ta: buffer.readIntBE(0, opcode - Opcode.z),\n\t\t\t\tlength: opcode - Opcode.z + 1,\n\t\t\t});\n\n\t\tcase Opcode.fnt1:\n\t\tcase Opcode.fnt2:\n\t\tcase Opcode.fnt3:\n\t\tcase Opcode.fnt4:\n\t\t\tif (buffer.length < opcode - Opcode.fnt1 + 1) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new SetFont({\n\t\t\t\tk: buffer.readIntBE(0, opcode - Opcode.fnt1 + 1),\n\t\t\t\tlength: opcode - Opcode.fnt1 + 1 + 1,\n\t\t\t});\n\n\t\tcase Opcode.xxx:\n\t\tcase Opcode.xxx2:\n\t\tcase Opcode.xxx3:\n\t\tcase Opcode.xxx4: {\n\t\t\tconst i = opcode - Opcode.xxx + 1;\n\t\t\tif (buffer.length < i) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\tconst k = buffer.readUIntBE(0, i);\n\t\t\tif (buffer.length < i + k) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new Special({\n\t\t\t\tx: buffer.slice(i, i + k).toString(),\n\t\t\t\tlength: i + k + 1,\n\t\t\t});\n\t\t}\n\n\t\tcase Opcode.fnt_def:\n\t\tcase Opcode.fnt_def2:\n\t\tcase Opcode.fnt_def3:\n\t\tcase Opcode.fnt_def4: {\n\t\t\tconst i = opcode - Opcode.fnt_def + 1;\n\t\t\tif (buffer.length < i) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\tconst k = buffer.readIntBE(0, i);\n\t\t\tif (buffer.length < i + 14) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\tconst cc = buffer.readUInt32BE(i + 0);\n\t\t\tconst s = buffer.readUInt32BE(i + 4);\n\t\t\tconst d = buffer.readUInt32BE(i + 8);\n\t\t\tconst a = buffer.readUInt8(i + 12);\n\t\t\tconst l = buffer.readUInt8(i + 13);\n\t\t\tif (buffer.length < i + 14 + a + l) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\tconst n = buffer.slice(i + 14, i + 14 + a + l).toString();\n\t\t\treturn new FontDefinition({\n\t\t\t\tk,\n\t\t\t\tcc,\n\t\t\t\ts,\n\t\t\t\td,\n\t\t\t\ta,\n\t\t\t\tl,\n\t\t\t\tn,\n\t\t\t\tlength: i + 14 + a + l + 1,\n\t\t\t});\n\t\t}\n\n\t\tcase Opcode.pre: {\n\t\t\tif (buffer.length < 14) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\tconst i = buffer.readUInt8(0);\n\t\t\tconst num = buffer.readUInt32BE(1);\n\t\t\tconst den = buffer.readUInt32BE(5);\n\t\t\tconst mag = buffer.readUInt32BE(9);\n\t\t\tconst k = buffer.readUInt8(13);\n\t\t\tif (buffer.length < 14 + k + 8) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\tconst comment = buffer.slice(14, 14 + k).toString();\n\t\t\treturn new Preamble({\n\t\t\t\ti,\n\t\t\t\tnum,\n\t\t\t\tden,\n\t\t\t\tmag,\n\t\t\t\tx: comment,\n\t\t\t\tlength: 14 + k + 1,\n\t\t\t});\n\t\t}\n\n\t\tcase Opcode.post:\n\t\t\tif (buffer.length < 4 + 4 + 4 + 4 + 4 + 4 + 2 + 2) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new Post({\n\t\t\t\tp: buffer.readUInt32BE(0),\n\t\t\t\tnum: buffer.readUInt32BE(4),\n\t\t\t\tden: buffer.readUInt32BE(8),\n\t\t\t\tmag: buffer.readUInt32BE(12),\n\t\t\t\tl: buffer.readUInt32BE(16),\n\t\t\t\tu: buffer.readUInt32BE(20),\n\t\t\t\ts: buffer.readUInt16BE(24),\n\t\t\t\tt: buffer.readUInt16BE(26),\n\t\t\t\tlength: 29,\n\t\t\t});\n\n\t\tcase Opcode.post_post:\n\t\t\tif (buffer.length < 5) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\treturn new PostPost({\n\t\t\t\tq: buffer.readUInt32BE(0),\n\t\t\t\ti: buffer.readUInt8(4),\n\t\t\t\tlength: 6,\n\t\t\t});\n\n\t\tcase Opcode.define_native_font: {\n\t\t\tif (buffer.length < 19) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\tconst fontnum = buffer.readUInt32BE(0);\n\t\t\tconst fontsize = buffer.readUInt32BE(4) / 65536;\n\t\t\tconst flag = buffer.readUInt16BE(8);\n\t\t\tconst filenamelen = buffer.readUInt8(10);\n\t\t\tconst filename = buffer.slice(11, 11 + filenamelen).toString();\n\t\t\tconst faceindex = buffer.readUInt32BE(11 + filenamelen);\n\t\t\tconst height = buffer.readUInt32BE(11 + filenamelen + 4);\n\t\t\tconst depth = buffer.readUInt32BE(11 + filenamelen + 8);\n\t\t\tconst res = new NativeFontDefinition({\n\t\t\t\tfontnumber: fontnum,\n\t\t\t\tfontsize,\n\t\t\t\tflag,\n\t\t\t\theight,\n\t\t\t\tdepth,\n\t\t\t\tfilenamelen,\n\t\t\t\tfilename,\n\t\t\t\tfaceindex,\n\t\t\t});\n\t\t\tconst XDV_FLAGS_COLORED = 0x0200;\n\t\t\tconst XDV_FLAG_EXTEND = 0x1000;\n\t\t\tconst XDV_FLAG_SLANT = 0x2000;\n\t\t\tconst XDV_FLAG_EMBOLDEN = 0x4000;\n\t\t\tlet length = 23 + filenamelen;\n\n\t\t\tif ((flag & XDV_FLAGS_COLORED) !== 0) {\n\t\t\t\tres.rbga = buffer.readUInt32BE(length);\n\t\t\t\tlength += 4;\n\t\t\t}\n\t\t\tif ((flag & XDV_FLAG_EXTEND) !== 0) {\n\t\t\t\tres.extend = buffer.readUInt32BE(length) / 65536.0;\n\t\t\t\tlength += 4;\n\t\t\t}\n\t\t\tif ((flag & XDV_FLAG_SLANT) !== 0) {\n\t\t\t\tres.slant = buffer.readUInt32BE(length) / 65536.0;\n\t\t\t\tlength += 4;\n\t\t\t}\n\t\t\tif ((flag & XDV_FLAG_EMBOLDEN) !== 0) {\n\t\t\t\tres.embolden = buffer.readUInt32BE(length) / 65536.0;\n\t\t\t\tlength += 4;\n\t\t\t}\n\t\t\tres.length = length + 1;\n\t\t\treturn res;\n\t\t}\n\t\tcase Opcode.set_text_and_glyphs: {\n\t\t\tif (buffer.length < 28) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode}`);\n\t\t\t}\n\t\t\tconst textcount = buffer.readUInt16BE(0);\n\t\t\tif (buffer.length < 2 + textcount * 10) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode} for textcount`);\n\t\t\t}\n\t\t\tconst text = [];\n\t\t\tconst char_ps = [];\n\t\t\tfor (let j = 0; j < textcount; j++) {\n\t\t\t\tconst n = buffer.readUInt16BE(2 + j * 10);\n\t\t\t\ttext.push(n);\n\t\t\t\tconst char_pp = new CharPosition();\n\t\t\t\tchar_pp.line = buffer.readUInt16BE(2 + j * 10 + 2);\n\t\t\t\tchar_pp.column = buffer.readUInt16BE(2 + j * 10 + 4);\n\t\t\t\tchar_pp.cs = buffer.readUInt16BE(2 + j * 10 + 6);\n\t\t\t\tchar_pp.group = buffer.readUInt8(2 + j * 10 + 8);\n\t\t\t\tchar_pp.fid = buffer.readUInt8(2 + j * 10 + 9);\n\t\t\t\tchar_ps.push(char_pp);\n\t\t\t}\n\t\t\tconst width = buffer.readUInt32BE(2 + textcount * 10);\n\t\t\tconst glyphcount = buffer.readUInt16BE(2 + textcount * 10 + 4);\n\t\t\t// console.log(`How many count? ${glyphcount}`);\n\t\t\tif (buffer.length < 2 + textcount * 10 + 6 + glyphcount * 10) {\n\t\t\t\tthrow new Error(`not enough bytes to process opcode ${opcode} ${buffer.length} ${glyphcount}`);\n\t\t\t}\n\t\t\tconst res = new SetTextGlyph({\n\t\t\t\ttextcount: textcount,\n\t\t\t\ttext: text,\n\t\t\t\ttextpos: char_ps,\n\t\t\t\twidth: width,\n\t\t\t\tglyphcount: glyphcount,\n\t\t\t\tlength: 2 + textcount * 10 + 6 + glyphcount * 10 + 1,\n\t\t\t});\n\t\t\treturn res;\n\t\t}\n\t}\n\n\tthrow new Error(`routine for ${opcode} is not implemented`);\n}\n\nfunction locatePagePtr(buffer: Buffer, lastBop: number, page: number): number {\n\tlet offset = lastBop;\n\twhile (offset > 0) {\n\t\tconst bop_opcode = buffer.readUInt8(offset);\n\t\tif (bop_opcode !== 139) {\n\t\t\tthrow new Error('Parse failed in reading bop preamble');\n\t\t}\n\t\tconst boppage = buffer.readUInt32BE(offset + 1) + 1;\n\t\tif (boppage < page) {\n\t\t\tthrow new Error('No such a page');\n\t\t}\n\t\tif (boppage === page) {\n\t\t\t// console.log(`Find page ${page}`);\n\t\t\tbreak;\n\t\t}\n\t\tconst _prevPtr = buffer.readUInt32BE(offset + 41);\n\t\tif (_prevPtr > offset) {\n\t\t\tthrow new Error('Parse failed in reading bop jump');\n\t\t}\n\t\toffset = _prevPtr;\n\t}\n\treturn offset;\n}\n\nfunction parseHeader(buffer: Buffer, machine: XDVMachine): number {\n\tlet offset = 0;\n\n\t// Parse Header\n\tconst preamble_code: Opcode = buffer.readUInt8(offset);\n\n\tif (preamble_code !== Opcode.pre) {\n\t\tthrow new Error(`Invalid Header ${Opcode.pre} ${preamble_code}`);\n\t}\n\n\tconst command = parseCommand(preamble_code, buffer.slice(offset + 1));\n\n\tcommand.execute(machine);\n\toffset += command.length;\n\n\t// Parse Footer\n\treturn offset;\n}\n\nfunction parseFileLists(buffer: Buffer, machine: XDVMachine, offset: number): void {\n\tconst skip_count = buffer.readUInt16BE(offset);\n\t// console.log('skip ' + (offset - skip_count));\n\tconst fileListStr = buffer.slice(offset - skip_count, offset).toString();\n\tconst fileList = fileListStr.split(';');\n\tfileList.pop();\n\tmachine.fileList = fileList;\n}\n\nfunction parseFooter(buffer: Buffer, machine: XDVMachine): number {\n\tlet offset = buffer.length - 1;\n\t// Locate Post\n\twhile (offset > 0) {\n\t\tconst opcode = buffer.readUInt8(offset);\n\t\tif (opcode === 223) {\n\t\t\toffset -= 1;\n\t\t} else if (opcode === FILE_VERSION) {\n\t\t\tbreak;\n\t\t} else {\n\t\t\tthrow new Error('Parse failed, signature check');\n\t\t}\n\t}\n\toffset -= 4;\n\n\t/* Two post post hack */\n\tparseFileLists(buffer, machine, offset - 2);\n\n\tlet prevPtr = buffer.readUInt32BE(offset);\n\tif (prevPtr > offset) {\n\t\tthrow new Error('Parse failed in reading post ending');\n\t}\n\toffset = prevPtr;\n\n\t// Post Sanity Check\n\tconst post_opcode = buffer.readUInt8(offset);\n\tif (post_opcode !== Opcode.post) {\n\t\tthrow new Error('Parse failed in reading post preamble');\n\t}\n\n\tconst total_page = buffer.readUInt16BE(offset + 27);\n\n\tmachine.totalPages = total_page;\n\n\tprevPtr = buffer.readUInt32BE(offset + 1);\n\tif (prevPtr > offset) {\n\t\tthrow new Error('Parse failed in reading post preamble');\n\t}\n\n\t// Parse fonts definition\n\twhile (offset < buffer.length) {\n\t\tconst opcode: Opcode = buffer.readUInt8(offset);\n\t\tconst command = parseCommand(opcode, buffer.slice(offset + 1));\n\n\t\tcommand.execute(machine);\n\t\toffset += command.length;\n\t\tif (command.opcode === Opcode.post_post) {\n\t\t\tbreak;\n\t\t}\n\n\t}\n\n\treturn prevPtr; // Last Bop\n}\n\nexport function parseXDV(dviContent: Buffer | Uint8Array, machine: XDVMachine, page: number): void {\n\tconst buffer = Buffer.from(dviContent);\n\n\tlet offset = 0;\n\n\tconst firstBop = parseHeader(buffer, machine);\n\n\tconst lastBop = parseFooter(buffer, machine);\n\n\t// Jump to Page\n\tif (page !== 0) {\n\t\toffset = locatePagePtr(buffer, lastBop, page);\n\t} else {\n\t\toffset = firstBop;\n\t}\n\n\twhile (offset < buffer.length) {\n\t\tconst opcode: Opcode = buffer.readUInt8(offset);\n\n\t\tconst command = parseCommand(opcode, buffer.slice(offset + 1));\n\n\t\tcommand.execute(machine);\n\n\t\toffset += command.length;\n\n\t\tif (page !== 0 && command.opcode === Opcode.eop) {\n\t\t\tbreak;\n\t\t}\n\t\tif (command.opcode === Opcode.post || command.opcode === Opcode.post_post) {\n\t\t\tbreak;\n\t\t}\n\t}\n}\n","/********************************************************************************\n * Copyright (C) 2019 Elliott Wen.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport const LATEX_SCHEME = 'latex';\nexport const LATEX_LANGUAGE_ID = 'latex';\nexport const LATEX_LANGUAGE_NAME = 'LaTeX';\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js!./index.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js!./index.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js!./index.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","/********************************************************************************\n * Copyright (C) 2018 Ericsson and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { TextmateRegistry } from './textmate-registry';\n\n/**\n * Callback for extensions to contribute language grammar definitions\n */\nexport const LanguageGrammarDefinitionContribution = Symbol('LanguageGrammarDefinitionContribution');\nexport interface LanguageGrammarDefinitionContribution {\n    registerTextmateLanguage(registry: TextmateRegistry): void;\n}\nexport function getEncodedLanguageId(languageId: string): number {\n    return monaco.languages.getEncodedLanguageId(languageId);\n}\n","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */"],"sourceRoot":""}